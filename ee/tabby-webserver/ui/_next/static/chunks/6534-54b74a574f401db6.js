(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6534],{72657:function(e,n,t){"use strict";t.d(n,{K:function(){return o}});var s=t(36164);t(3546);var l=t(12624),a=t(1544),r=t(31458),i=t(81565);function o(e){let{className:n,container:t,offset:o,...d}=e,c=(0,l.e)(o||0,t);return(0,s.jsxs)(r.z,{variant:"outline",size:"icon",className:(0,a.cn)("absolute right-4 top-1 z-10 bg-background transition-opacity duration-300 sm:right-8 md:top-2",c?"opacity-0":"opacity-100",n),onClick:()=>{t?t.scrollTo({top:t.scrollHeight,behavior:"smooth"}):window.scrollTo({top:document.body.offsetHeight,behavior:"smooth"})},...d,children:[(0,s.jsx)(i.IconArrowDown,{}),(0,s.jsx)("span",{className:"sr-only",children:"Scroll to bottom"})]})}},66534:function(e,n,t){"use strict";t.d(n,{e:function(){return eS},p:function(){return eE}});var s=t(36164),l=t(3546),a=t(1853),r=t(78613),i=t(82157),o=t(72940),d=t(70783),c=t(21808),u=t(24449),m=t(16784),h=t(64566),x=t(63484),v=t(17451),f=t(1544),p=t(90379),g=t(54767),j=t(94755),b=t(28445),y=t(84837),C=t(2578),N=t(28312),w=t(47241),k=t(11634),I=t(70410),A=t(63795),M=t(31458),E=t(81565),S=t(72657),L=t(45391),R=t(34021),T=t(21454),_=t(3765),z=t(84942),D=t(29),Z=t(24685),O=t(74630),F=t(16234),P=t(23455),U=t(82394);let H=l.createContext({}),J=z.xp,$=l.forwardRef((e,n)=>(0,s.jsx)(z.tW,{...e,ref:n}));$.displayName="SearchableSelectAnchor";let q=l.forwardRef((e,n)=>{let{getInputProps:t}=l.useContext(H),{onKeyDown:a,onChange:r,onInput:i,onBlur:o,onClick:d,...c}=e;return(0,s.jsx)(P.Z,{...t((0,F.Z)({onKeyDown:a,onChange:r,onInput:i,onBlur:o,onClick:d,ref:n},O.Z)),...c})});q.displayName="SearchableSelectTextarea";let W=l.forwardRef((e,n)=>{let{getInputProps:t}=l.useContext(H),{onKeyDown:a,onChange:r,onInput:i,onBlur:o,onClick:d,...c}=e;return(0,s.jsx)(U.I,{...t((0,F.Z)({onKeyDown:a,onChange:r,onInput:i,onBlur:o,onClick:d,ref:n},O.Z)),...c})});W.displayName="SearchableSelectInput";let G=l.forwardRef((e,n)=>{let{children:t,style:a,popupMatchAnchorWidth:r,...i}=e,{getMenuProps:o,anchorRef:d}=l.useContext(H),c=l.useRef(void 0);return l.useLayoutEffect(()=>{if(r){let e=d.current;if(e){let n=e.getBoundingClientRect();c.current=n.width}}},[]),(0,s.jsx)(z.i9,{children:(0,s.jsx)(z.yk,{align:"start",onOpenAutoFocus:e=>e.preventDefault(),style:{width:c.current,...a},...o({ref:n},{suppressRefError:!0}),...i,children:t})})});G.displayName="SearchableSelectContent";let V=l.forwardRef((e,n)=>{let{item:t,index:a,className:r,children:i,disabled:o,...d}=e,{highlightedIndex:c,selectedItem:u,getItemProps:m}=l.useContext(H),h=c===a,x=u===t;return(0,s.jsx)(J,{asChild:!0,children:(0,s.jsx)("div",{className:(0,f.cn)("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none",h&&"bg-accent text-accent-foreground",x&&"font-bold",o&&"pointer-events-none opacity-50",r),...m({item:t,index:a,onMouseLeave:e=>e.preventDefault(),onMouseOut:e=>e.preventDefault()}),...d,children:"function"==typeof i?i({highlighted:h,selected:x}):i})},t.id)});function Y(e){let{options:n,onSelect:t,children:a,open:r,onOpenChange:i,stayOpenOnInputClick:o}=e,d=l.useRef(null),c=l.useCallback((e,n)=>{let{type:t,changes:s}=n;switch(t){case Z.Kb.stateChangeTypes.MenuMouseLeave:return{...s,highlightedIndex:e.highlightedIndex};case Z.Kb.stateChangeTypes.InputClick:let l=!!o||s.isOpen;return{...s,isOpen:l};default:return s}},[o]),u=(0,Z.Kb)({items:null!=n?n:[],defaultIsOpen:r,onSelectedItemChange(e){let{selectedItem:n}=e;n&&(null==t||t(n),null==i||i(!1))},onIsOpenChange:e=>{let{isOpen:n}=e;null==i||i(!!n)},stateReducer:c}),{setHighlightedIndex:m,highlightedIndex:h}=u,x=(0,O.Z)(r)?u.isOpen:u.isOpen&&r;l.useEffect(()=>{x&&(null==n?void 0:n.length)&&-1===h&&m(0)},[x,n]);let v=l.useMemo(()=>({...u,open:x,anchorRef:d}),[u,x,d]);return(0,s.jsx)(H.Provider,{value:v,children:(0,s.jsx)(z.J2,{open:x,children:"function"==typeof a?a(v):a})})}V.displayName="SearchableSelectOption";let B=l.forwardRef(function(e,n){let{onSubmit:t,input:a,setInput:r,isLoading:i,chatInputRef:o}=e,{formRef:d,onKeyDown:c}=function(){let e=(0,l.useRef)(null);return{formRef:e,onKeyDown:n=>{if("Enter"===n.key&&!n.shiftKey&&!n.nativeEvent.isComposing){var t;null===(t=e.current)||void 0===t||t.requestSubmit(),n.preventDefault()}}}}(),[u,m]=l.useState(null),[h,x]=l.useState(!1),v=l.useRef(),p=l.useRef(),[g,j]=l.useState([]),[b,y]=l.useState({}),{data:C}=(0,T.ZP)(u,_.Z,{revalidateOnFocus:!1,dedupingInterval:0,errorRetryCount:0});l.useEffect(()=>{var e;let n=null!==(e=null==C?void 0:C.hits)&&void 0!==e?e:[];j(n),x(!!(null==n?void 0:n.length))},[null==C?void 0:C.hits]),l.useImperativeHandle(n,()=>({focus:()=>{var e;return null===(e=o.current)||void 0===e?void 0:e.focus()}})),l.useEffect(()=>{a&&o.current&&o.current!==document.activeElement&&o.current.focus()},[a,o]),l.useLayoutEffect(()=>{var e,n,t;(null===(e=p.current)||void 0===e?void 0:e.length)&&(null===(t=o.current)||void 0===t||null===(n=t.setSelectionRange)||void 0===n||n.call(t,p.current[0],p.current[1]),p.current=void 0)},[o]),l.useMemo(()=>(0,L.Z)(e=>{var n,t,s,l;let a=null!==(s=null===(n=e.target)||void 0===n?void 0:n.value)&&void 0!==s?s:"",r=null!==(l=null===(t=e.target)||void 0===t?void 0:t.selectionEnd)&&void 0!==l?l:0,i=K(a,r),o=null==i?void 0:i[1];if(o){let e=encodeURIComponent("name:".concat(o," AND kind:function")),n="/v1beta/search?q=".concat(e);m(n)}else j([]),x(!1)},200),[]);let N=async e=>{if(e.preventDefault(),!(null==a?void 0:a.trim())||i)return;let n=a;Object.keys(b).forEach(e=>{var t,s,l;let a=b[e];(null==a?void 0:a.doc)&&(n=n.replaceAll(e,"\n```".concat(null!==(s=null===(t=a.doc)||void 0===t?void 0:t.language)&&void 0!==s?s:"","\n").concat(null!==(l=a.doc.body)&&void 0!==l?l:"","\n","```","\n")))}),r(""),await t(n)},w=(e,n)=>{"Enter"===e.key&&n?e.preventDefault():n&&["ArrowRight","ArrowLeft","Home","End"].includes(e.key)?(j([]),x(!1)):(n||(e.preventDownshiftDefault=!0),c(e))};return(0,s.jsx)("form",{onSubmit:N,ref:d,children:(0,s.jsx)(Y,{options:g,onSelect:e=>{var n,t,s;let l=null!==(n=v.current)&&void 0!==n?n:0,i=K(a,l);if(i){y({...b,["@".concat(null===(t=e.doc)||void 0===t?void 0:t.name)]:e});let n="@".concat(null==e?void 0:null===(s=e.doc)||void 0===s?void 0:s.name," "),o=a.substring(0,l).replace(new RegExp(i[0]),""),d=o.length+n.length;p.current=[d,d],r(o+n+a.slice(l))}j([]),x(!1)},open:h,onOpenChange:e=>{e&&(null==g?void 0:g.length)?x(e):(x(!1),j([]))},children:e=>{var n,t,l,d;let{open:c,highlightedIndex:u}=e,m=null==g?void 0:g[u];return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)($,{children:(0,s.jsxs)("div",{className:"relative flex max-h-60 w-full grow flex-col overflow-hidden bg-background px-8 sm:rounded-md sm:border sm:px-12",children:[(0,s.jsx)("span",{className:(0,f.cn)((0,M.d)({size:"sm",variant:"ghost"}),"absolute left-0 top-4 h-8 w-8 rounded-full bg-background p-0 hover:bg-background sm:left-4"),children:(0,s.jsx)(E.IconEdit,{})}),(0,s.jsx)(q,{tabIndex:0,rows:1,placeholder:"Ask a question.",spellCheck:!1,className:"min-h-[60px] w-full resize-none bg-transparent px-4 py-[1.3rem] focus-within:outline-none",value:a,ref:o,onChange:e=>{(0,R.Z)(e,"target.value")?(v.current=e.target.selectionEnd,r(e.target.value)):v.current=void 0},onKeyDown:e=>w(e,c)}),(0,s.jsx)("div",{className:"absolute right-0 top-4 sm:right-4",children:(0,s.jsxs)(D.u,{children:[(0,s.jsx)(D.aJ,{asChild:!0,children:(0,s.jsxs)(M.z,{type:"submit",size:"icon",disabled:i||""===a,children:[(0,s.jsx)(E.IconArrowElbow,{}),(0,s.jsx)("span",{className:"sr-only",children:"Send message"})]})}),(0,s.jsx)(D._v,{children:"Send message"})]})})]})}),(0,s.jsx)(G,{align:"start",side:"top",onOpenAutoFocus:e=>e.preventDefault(),className:"w-[60vw] md:w-[430px]",children:(0,s.jsxs)(z.J2,{open:c&&!!m,children:[(0,s.jsx)(z.tW,{asChild:!0,children:(0,s.jsx)("div",{className:"max-h-[300px] overflow-y-scroll",children:c&&!!(null==g?void 0:g.length)&&g.map((e,n)=>{var t,l,a;return(0,s.jsx)(V,{item:e,index:n,children:(0,s.jsxs)("div",{className:"flex w-full items-center justify-between gap-8 overflow-x-hidden",children:[(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[(0,s.jsx)(Q,{kind:null==e?void 0:null===(t=e.doc)||void 0===t?void 0:t.kind}),(0,s.jsxs)("div",{className:"max-w-[200px] truncate",children:[null==e?void 0:null===(l=e.doc)||void 0===l?void 0:l.name,"(...)"]})]}),(0,s.jsx)("div",{className:"flex-1 truncate text-right text-sm text-muted-foreground",children:null==e?void 0:null===(a=e.doc)||void 0===a?void 0:a.body})]})},null==e?void 0:e.id)})})}),(0,s.jsx)(z.yk,{asChild:!0,align:"start",side:"right",alignOffset:-4,onOpenAutoFocus:e=>e.preventDefault(),onKeyDownCapture:e=>e.preventDefault(),className:"rounded-none",collisionPadding:{bottom:120},children:(0,s.jsxs)("div",{className:"flex max-h-[70vh] w-[20vw] flex-col overflow-y-auto px-2 md:w-[240px] lg:w-[340px]",children:[(0,s.jsxs)("div",{className:"mb-2",children:[(null==m?void 0:null===(n=m.doc)||void 0===n?void 0:n.kind)?"(".concat(null==m?void 0:null===(t=m.doc)||void 0===t?void 0:t.kind,") "):"",null==m?void 0:null===(l=m.doc)||void 0===l?void 0:l.name]}),(0,s.jsx)("div",{className:"flex-1 whitespace-pre-wrap break-all text-muted-foreground",children:null==m?void 0:null===(d=m.doc)||void 0===d?void 0:d.body})]})})]})})]})}})})});function K(e,n){let t=e.substring(0,n),s=/@(\w+)$/.exec(t);return s}function Q(e){let{kind:n,...t}=e;return(0,s.jsx)(E.IconSymbolFunction,{...t})}function X(e){let{href:n,children:t}=e;return(0,s.jsxs)("a",{href:n,target:"_blank",className:"inline-flex flex-1 justify-center gap-1 leading-4 hover:underline",children:[(0,s.jsx)("span",{children:t}),(0,s.jsx)("svg",{"aria-hidden":"true",height:"7",viewBox:"0 0 6 6",width:"7",className:"opacity-70",children:(0,s.jsx)("path",{d:"M1.25215 5.54731L0.622742 4.9179L3.78169 1.75597H1.3834L1.38936 0.890915H5.27615V4.78069H4.40513L4.41109 2.38538L1.25215 5.54731Z",fill:"currentColor"})})]})}function ee(e){let{className:n,...t}=e;return(0,s.jsxs)("p",{className:(0,f.cn)("px-2 text-center text-xs leading-normal text-muted-foreground",n),...t,children:[(0,s.jsx)(X,{href:"https://tabby.tabbyml.com",children:"Tabby"}),", an opensource, self-hosted AI coding assistant ."]})}let en=l.forwardRef(function(e,n){var t;let{stop:r,reload:i,input:o,setInput:d,className:u,onSubmit:m,chatMaxWidthClass:h,chatInputRef:x}=e,p=l.useRef(null),{threadId:L,container:R,onClearMessages:T,qaPairs:_,isLoading:z,relevantContext:Z,removeRelevantContext:O,activeSelection:F,onCopyContent:P}=l.useContext(eE),U=(0,v.a)(e=>e.enableActiveSelection),[H,J]=(0,l.useState)(!1),{width:$}=(0,j.iP)(),q="number"==typeof $&&$<376,W=(0,l.useMemo)(()=>{var e;if(!L)return"";let n=null===(e=_[0])||void 0===e?void 0:e.user.message;if(!n)return L;let t=(0,f.i8)([],n,{maxLength:c.$I}),s=(0,g.Z)(t),l=(0,a.Z)([s,L]).join("-");return l},[null===(t=_[0])||void 0===t?void 0:t.user.message,L]),G=(0,k.Db)(I.md,{onError(e){C.A.error(e.message)}}),{isCopied:V,copyToClipboard:Y}=(0,N.m)({timeout:2e3,onCopyContent:P}),K=async()=>{if(L&&!V&&!H)try{var e,n;J(!0);let t=await G({threadId:L});if(null==t?void 0:null===(e=t.data)||void 0===e?void 0:e.setThreadPersisted){let e=new URL(window.location.origin);e.pathname="/search/".concat(W),Y(e.toString())}else C.A.error((null==t?void 0:null===(n=t.error)||void 0===n?void 0:n.message)||"Failed to share")}catch(e){}finally{J(!1)}};return l.useImperativeHandle(n,()=>({focus:()=>{var e;null===(e=p.current)||void 0===e||e.focus()}}),[]),(0,s.jsxs)("div",{className:u,children:[(0,s.jsx)(S.K,{container:R}),(0,s.jsxs)("div",{className:"mx-auto md:px-4 ".concat(h),children:[(0,s.jsxs)("div",{className:(0,f.cn)("flex h-10 items-center justify-center",q?"gap-3":"gap-2"),children:[z?(0,s.jsxs)(D.u,{children:[(0,s.jsx)(D.aJ,{asChild:!0,children:(0,s.jsxs)(M.z,{variant:"outline",onClick:()=>r(),className:"gap-2 bg-background",children:[(0,s.jsx)(E.IconStop,{}),!q&&"Stop generating"]})}),(0,s.jsx)(D._v,{hidden:!q,children:"Stop generating"})]}):(null==_?void 0:_.length)>0&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(D.u,{children:[(0,s.jsx)(D.aJ,{asChild:!0,children:(0,s.jsxs)(M.z,{variant:"outline",onClick:()=>i(),className:"gap-2 bg-background",children:[(0,s.jsx)(E.IconRefresh,{}),!q&&"Regenerate"]})}),(0,s.jsx)(D._v,{hidden:!q,children:"Regenerate"})]}),(0,s.jsxs)(D.u,{children:[(0,s.jsx)(D.aJ,{asChild:!0,children:(0,s.jsxs)(M.z,{variant:"outline",className:"gap-2 bg-background",onClick:K,children:[V?(0,s.jsx)(E.IconCheck,{}):(0,s.jsx)(E.IconShare,{}),!q&&"Share"]})}),(0,s.jsx)(D._v,{hidden:!q,children:"Share"})]})]}),(null==_?void 0:_.length)>0&&(0,s.jsxs)(D.u,{children:[(0,s.jsx)(D.aJ,{asChild:!0,children:(0,s.jsxs)(M.z,{variant:"outline",onClick:T,className:"gap-2 bg-background",children:[(0,s.jsx)(E.IconTrash,{}),!q&&"Clear"]})}),(0,s.jsx)(D._v,{hidden:!q,children:"Clear"})]})]}),(0,s.jsxs)("div",{className:"border-t bg-background px-4 py-2 shadow-lg sm:space-y-4 sm:rounded-t-xl sm:border md:py-4",children:[(0,s.jsx)("div",{className:"flex flex-wrap gap-2",children:(0,s.jsxs)(b.M,{presenceAffectsLayout:!0,children:[F?(0,s.jsx)(y.E.div,{initial:{opacity:0,scale:.9,y:-5},animate:{opacity:1,scale:1,y:0},transition:{ease:"easeInOut",duration:.1},exit:{opacity:0,scale:.9,y:5},children:(0,s.jsxs)(A.C,{variant:"outline",className:(0,f.cn)("inline-flex h-7 flex-nowrap items-center gap-1.5 overflow-hidden rounded-md pr-0 text-sm font-semibold",{"border-dashed !text-muted-foreground italic line-through":!U}),children:[(0,s.jsx)(et,{context:F,className:"flex-1 truncate"}),(0,s.jsx)("span",{className:"shrink-0 text-muted-foreground",children:"Current file"}),(0,s.jsx)(M.z,{size:"icon",variant:"ghost",className:"h-7 w-7 shrink-0 rounded-l-none",onClick:e=>{(0,w.qs)(!U)},children:U?(0,s.jsx)(E.IconEye,{}):(0,s.jsx)(E.IconEyeOff,{})})]})}):null,Z.map((e,n)=>(0,s.jsx)(y.E.div,{initial:{opacity:0,scale:.9,y:-5},animate:{opacity:1,scale:1,y:0},transition:{ease:"easeInOut",duration:.1},exit:{opacity:0,scale:.9,y:5},layout:!0,children:(0,s.jsxs)(A.C,{variant:"outline",className:"inline-flex h-7 flex-nowrap items-center gap-1 overflow-hidden rounded-md pr-0 text-sm font-semibold",children:[(0,s.jsx)(et,{context:e}),(0,s.jsx)(M.z,{size:"icon",variant:"ghost",className:"h-7 w-7 shrink-0 rounded-l-none",onClick:O.bind(null,n),children:(0,s.jsx)(E.IconRemove,{})})]})},e.filepath+e.range.start+e.range.end))]})}),(0,s.jsx)(B,{ref:p,onSubmit:m,input:o,setInput:d,isLoading:z,chatInputRef:x}),(0,s.jsx)(ee,{className:"hidden sm:block"})]})]})]})});function et(e){let{context:n,className:t}=e,[l]=n.filepath.split("/").slice(-1),a=n.range.start===n.range.end?":".concat(n.range.start):":".concat(n.range.start,"-").concat(n.range.end);return(0,s.jsxs)("span",{className:(0,f.cn)("truncate",t),children:[l,(0,s.jsx)("span",{className:"text-muted-foreground",children:a})]})}var es=t(76297),el=t(12624);function ea(e){let{trackVisibility:n}=e,{container:t}=l.useContext(eE),a=(0,el.e)(100,t),{ref:r,entry:i,inView:o}=(0,es.YD)({trackVisibility:n,delay:100,rootMargin:"0px 0px -150px 0px",root:t});return l.useEffect(()=>{a&&n&&!o&&(null==i||i.target.scrollIntoView({block:"start"}))},[o,i,a,n]),(0,s.jsx)("div",{ref:r,className:"h-px w-full"})}let er=[{heading:"Convert list of string to numbers",message:"How to convert a list of string to numbers in python"},{heading:"How to parse email address",message:"How to parse email address with regex"}];function ei(e){let{setInput:n,chatMaxWidthClass:t,welcomeMessage:l}=e;return(0,s.jsx)("div",{className:"mx-auto px-4 ".concat(t),children:(0,s.jsxs)("div",{className:"rounded-lg border bg-background p-8",children:[(0,s.jsx)("h1",{className:"mb-2 text-lg font-semibold",children:l||"Welcome"}),(0,s.jsx)("p",{className:"leading-normal text-muted-foreground",children:"You can start a conversation here or try the following examples:"}),(0,s.jsx)("div",{className:"mt-4 flex flex-col items-start space-y-2",children:er.map((e,t)=>(0,s.jsxs)(M.z,{variant:"link",className:"h-auto p-0 text-base",onClick:()=>n(e.message),children:[(0,s.jsx)(E.IconArrowRight,{className:"mr-2 text-muted-foreground"}),(0,s.jsx)("p",{className:"text-left",children:e.heading})]},t))})]})})}var eo=t(42891),ed=t.n(eo),ec=t(23342),eu=t(94909),em=t(74038),eh=t(98454),ex=t(48537),ev=t(21540),ef=t(11208),ep=t(3448),eg=t(52569),ej=t(90168);function eb(e){let{messages:n,chatMaxWidthClass:t}=e,{isLoading:a}=l.useContext(eE);return(0,s.jsx)("div",{className:"relative mx-auto px-4 ".concat(t),children:null==n?void 0:n.map((e,t)=>{let r=t===n.length-1;return(0,s.jsxs)(l.Fragment,{children:[(0,s.jsx)(ey,{isLoading:!!r&&a,message:e,isLastItem:r}),!r&&(0,s.jsx)(ef.Z,{className:"my-4 md:my-8"})]},e.user.id)})})}function ey(e){let{message:n,isLoading:t,isLastItem:l}=e,{user:a,assistant:r}=n;return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(eC,{message:a}),!!r&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(ef.Z,{className:"my-4 md:my-8"}),(0,s.jsx)(ew,{message:r,userMessage:a,isLoading:t,userMessageId:a.id,enableRegenerating:l})]})]})}function eC(e){var n,t,a,r;let{message:i}=e,[{data:o}]=(0,eh.P)(),d=i.selectContext,{onNavigateToContext:c,supportsOnApplyInEditorV2:u}=l.useContext(eE),m=l.useMemo(()=>{var e,n;if(!(null==d?void 0:d.content))return"";let t=(null==d?void 0:d.filepath)&&null!==(e=(0,x.U$)(null==d?void 0:d.filepath)[0])&&void 0!==e?e:"";return"\n```".concat(t,"\n").concat(null!==(n=null==d?void 0:d.content)&&void 0!==n?n:"","\n","```","\n")},[d]),h=null;if(m&&i.selectContext){let{range:e,filepath:n}=i.selectContext;h={filepath:n,isMultiLine:!(0,O.Z)(null==e?void 0:e.start)&&!(0,O.Z)(null==e?void 0:e.end)&&e.start<e.end}}return(0,s.jsxs)("div",{className:(0,f.cn)("group relative mb-4 flex flex-col items-start gap-y-2 md:-ml-4 md:flex-row"),...e,children:[(0,s.jsxs)("div",{className:(0,f.cn)("flex min-h-[2rem] w-full items-center justify-between md:w-auto",{"hidden md:flex":!(null==o?void 0:o.me.name)}),children:[(0,s.jsxs)("div",{className:"flex items-center gap-x-2",children:[(0,s.jsx)("div",{className:"shrink-0 select-none rounded-full border bg-background shadow",children:(0,s.jsx)(eg.SQ,{className:"h-6 w-6 md:h-8 md:w-8",fallback:(0,s.jsx)("div",{className:"flex h-6 w-6 items-center justify-center md:h-8 md:w-8",children:(0,s.jsx)(E.IconUser,{className:"h-6 w-6"})})})}),(0,s.jsx)("p",{className:"block text-xs font-bold md:hidden",children:null==o?void 0:o.me.name})]}),(0,s.jsx)("div",{className:"block opacity-0 transition-opacity group-hover:opacity-100 md:hidden",children:(0,s.jsx)(eN,{...e})})]}),(0,s.jsxs)("div",{className:"group relative flex w-full justify-between gap-x-2",children:[(0,s.jsxs)("div",{className:"flex-1 space-y-2 overflow-hidden px-1 md:ml-4",children:[(0,s.jsx)(ev.JG,{message:i.message,canWrapLongLines:!0,supportsOnApplyInEditorV2:u}),(0,s.jsx)("div",{className:"hidden md:block",children:(0,s.jsx)(eN,{...e})}),h&&i.selectContext&&(0,s.jsxs)("div",{className:"flex cursor-pointer items-center gap-1 overflow-x-auto text-xs text-muted-foreground hover:underline",onClick:()=>null==c?void 0:c(i.selectContext,{openInEditor:!0}),children:[(0,s.jsx)(E.IconFile,{className:"h-3 w-3"}),(0,s.jsxs)("p",{className:"flex-1 truncate pr-1",children:[(0,s.jsx)("span",{children:h.filepath}),(null===(t=i.selectContext)||void 0===t?void 0:null===(n=t.range)||void 0===n?void 0:n.start)&&(0,s.jsxs)("span",{children:[":",null===(a=i.selectContext)||void 0===a?void 0:a.range.start]}),h.isMultiLine&&(0,s.jsxs)("span",{children:["-",null===(r=i.selectContext)||void 0===r?void 0:r.range.end]})]})]})]}),!(null==o?void 0:o.me.name)&&(0,s.jsx)("div",{className:"editor-bg absolute right-0 top-0 -mt-0.5 block opacity-0 transition-opacity group-hover:opacity-100 md:hidden",children:(0,s.jsx)(eN,{...e})})]})]})}function eN(e){let{message:n}=e,{handleMessageAction:t,isLoading:a}=l.useContext(eE);return(0,s.jsxs)(eM,{children:[!a&&(0,s.jsxs)(M.z,{variant:"ghost",size:"icon",onClick:e=>t(n.id,"edit"),children:[(0,s.jsx)(E.IconEdit,{}),(0,s.jsx)("span",{className:"sr-only",children:"Edit message"})]}),!a&&(0,s.jsxs)(M.z,{variant:"ghost",size:"icon",onClick:e=>t(n.id,"delete"),children:[(0,s.jsx)(E.IconTrash,{}),(0,s.jsx)("span",{className:"sr-only",children:"Delete message"})]})]})}function ew(e){let{message:n,userMessage:t,isLoading:r,userMessageId:o,enableRegenerating:c,...u}=e,{onNavigateToContext:m,onApplyInEditor:h,onCopyContent:v,onLookupSymbol:p,openInEditor:g,supportsOnApplyInEditorV2:j}=l.useContext(eE),[b,y]=l.useState(void 0),C=l.useMemo(()=>{var e,t;return null!==(t=null==n?void 0:null===(e=n.relevant_code)||void 0===e?void 0:e.map(e=>{let{startLine:n,endLine:t}=(0,f.OV)(e);return{kind:"file",range:{start:n,end:t},filepath:e.filepath,content:e.content,git_url:e.gitUrl}}))&&void 0!==t?t:[]},[null==n?void 0:n.relevant_code]),N=l.useMemo(()=>{var e;return(0,d.Z)((0,a.Z)([t.activeContext,...null!==(e=null==t?void 0:t.relevantContext)&&void 0!==e?e:[]]),i.Z)},[t.activeContext,t.relevantContext]),w=(0,l.useMemo)(()=>{var e,n;let t=null!==(n=null==N?void 0:N.map(n=>({content:n.content,filepath:n.filepath,gitUrl:n.git_url,startLine:n.range.start,language:(0,x.U$)(null!==(e=n.filepath)&&void 0!==e?e:"")[0],isClient:!0})))&&void 0!==n?n:[];return t},[N]),k=(0,l.useMemo)(()=>{var e,n;let t=null!==(n=null==C?void 0:C.map(n=>({content:n.content,filepath:n.filepath,gitUrl:n.git_url,startLine:n.range.start,language:(0,x.U$)(null!==(e=n.filepath)&&void 0!==e?e:"")[0],isClient:!1})))&&void 0!==n?n:[];return(0,a.Z)([...t])},[C]);return(0,s.jsxs)("div",{className:(0,f.cn)("group relative mb-4 flex flex-col items-start gap-y-2 md:-ml-4 md:flex-row"),...u,children:[(0,s.jsxs)("div",{className:"flex min-h-[2rem] w-full items-center justify-between md:w-auto",children:[(0,s.jsxs)("div",{className:"flex items-center gap-x-2",children:[(0,s.jsx)("div",{className:"shrink-0 select-none rounded-full border bg-background shadow",children:(0,s.jsx)(eA,{className:"h-6 w-6 md:h-8 md:w-8"})}),(0,s.jsx)("p",{className:"block text-xs font-bold md:hidden",children:"Tabby"})]}),(0,s.jsx)("div",{className:"block opacity-0 transition-opacity group-hover:opacity-100 md:hidden",children:(0,s.jsx)(ek,{message:n,userMessageId:o,enableRegenerating:c,attachmentCode:k})})]}),(0,s.jsxs)("div",{className:"w-full flex-1 space-y-2 overflow-hidden px-1 md:ml-4",children:[(0,s.jsx)(ej.q,{contexts:C,clientContexts:N,onContextClick:(e,n)=>{null==m||m(e,{openInEditor:n})},showExternalLink:!!h,isInEditor:!!h,showClientCodeIcon:!h,highlightIndex:b,triggerClassname:"md:pt-0"}),!r||(null==n?void 0:n.message)?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(ev.JG,{message:n.message,onApplyInEditor:h,onCopyContent:v,attachmentClientCode:w,attachmentCode:k,onCodeCitationClick:e=>{let{startLine:n,endLine:t}=(0,f.OV)(e),s={git_url:e.gitUrl,content:e.content,filepath:e.filepath,kind:"file",range:{start:n,end:t}};null==m||m(s,{openInEditor:e.isClient})},onCodeCitationMouseEnter:e=>{y(e-1-0)},onCodeCitationMouseLeave:e=>{y(void 0)},canWrapLongLines:!r,onLookupSymbol:p,openInEditor:g,supportsOnApplyInEditorV2:j,activeSelection:t.activeContext}),!!n.error&&(0,s.jsx)(ev.mE,{error:n.error})]}):(0,s.jsx)(eI,{}),(0,s.jsx)("div",{className:"hidden md:block",children:(0,s.jsx)(ek,{message:n,userMessageId:o,enableRegenerating:c,attachmentCode:k})})]})]})}function ek(e){let{handleMessageAction:n,isLoading:t,onCopyContent:r}=l.useContext(eE),{message:i,userMessageId:o,enableRegenerating:d,attachmentCode:c}=e,u=(0,l.useMemo)(()=>(function(e,n){var t;if(!n||(0,eu.Z)(n))return e;let s=e.replace(em.H,e=>{let n=null==e?void 0:e.match(/\d+/);return"[".concat(n,"]")}).trim(),l=null!==(t=n.map((e,n)=>{let t=(0,f.tf)(e),s=(0,a.Z)([e.filepath,t]).join(":");return"[".concat(n+1,"] ").concat(s)}).join("\n"))&&void 0!==t?t:"";return"".concat(s,"\n\nCitations:\n").concat(l)})(i.message,c),[i.message,c]);return(0,s.jsxs)(eM,{children:[!t&&d&&(0,s.jsxs)(M.z,{variant:"ghost",size:"icon",onClick:e=>n(o,"regenerate"),children:[(0,s.jsx)(E.IconRefresh,{}),(0,s.jsx)("span",{className:"sr-only",children:"Regenerate message"})]}),(0,s.jsx)(ex.q,{value:u,onCopyContent:r})]})}function eI(){return(0,s.jsxs)("div",{className:"space-y-2 py-2 md:px-1 md:py-0",children:[(0,s.jsx)(ep.O,{className:"h-3 w-full"}),(0,s.jsx)(ep.O,{className:"h-3 w-full"})]})}function eA(e){let{className:n}=e;return(0,s.jsx)(ed(),{style:{backgroundColor:"#E8E2D2"},className:(0,f.cn)("rounded-full p-0.5",n),src:ec.Z,alt:"tabby"})}function eM(e){let{className:n,...t}=e;return(0,s.jsx)("div",{className:(0,f.cn)("flex items-center justify-end transition-opacity group-hover:opacity-100 md:absolute md:-right-[4rem] md:-top-2 md:opacity-0",n),...t})}let eE=l.createContext({}),eS=l.forwardRef(function(e,n){let{className:t,chatId:g,initialMessages:j,onLoaded:b,onThreadUpdates:y,onNavigateToContext:C,container:N,docQuery:w,generateRelevantQuestions:k,maxWidth:I,welcomeMessage:A,promptFormClassname:M,onCopyContent:E,onSubmitMessage:S,onApplyInEditor:L,onLookupSymbol:R,openInEditor:T,chatInputRef:_,supportsOnApplyInEditorV2:z}=e,[D,Z]=l.useState(!1),[O,F]=l.useState(),P=l.useRef(!1),[U,H]=l.useState(null!=j?j:[]),[J,$]=l.useState(""),[q,W]=l.useState([]),[G,V]=l.useState(null),Y=(0,v.a)(e=>e.enableActiveSelection),B=l.useRef(null),{sendUserMessage:K,isLoading:Q,error:X,answer:ee,stop:et,regenerate:es,deleteThreadMessagePair:el}=(0,h.x)({threadId:O}),er=async e=>{var n;if(!O)return;et();let t=U.find(n=>n.user.id===e);if(!(null==t?void 0:t.user)||!t.assistant)return;let s=U.filter(n=>n.user.id!==e);H(s),el(O,null==t?void 0:t.user.id,null==t?void 0:null===(n=t.assistant)||void 0===n?void 0:n.id)},eo=async e=>{if(!O)return;let n=(0,r.Z)(U,n=>n.user.id===e);if(n>-1){let e=U[n];if(!e.assistant)return;let t=(0,f.x0)(),s=(0,f.x0)();H([...U.slice(0,n),{user:{...e.user,id:t},assistant:{id:s,message:"",error:void 0}}]);let[l,a]=eh(e.user,Y);return es({threadId:O,userMessageId:e.user.id,assistantMessageId:e.assistant.id,userMessage:l,threadRunOptions:a})}},ed=async e=>{var n,t;if(!O)return;let s=U.find(n=>n.user.id===e);if(!(null==s?void 0:s.user)||!s.assistant)return;let l=s.user,a=[];(null===(n=l.relevantContext)||void 0===n?void 0:n.length)&&(a=a.concat(l.relevantContext)),W((0,d.Z)(a,i.Z));let r=U.filter(n=>n.user.id!==e);H(r),$(l.message),l.activeContext&&C(l.activeContext,{openInEditor:!0}),el(O,null==s?void 0:s.user.id,null==s?void 0:null===(t=s.assistant)||void 0===t?void 0:t.id)},ec=async()=>{if(!(null==U?void 0:U.length))return;let e=U[U.length-1].user.id;return eo(e)},eu=()=>{et(!0),H([]),F(void 0)};l.useEffect(()=>{if(!(null==U?void 0:U.length)||!ee)return;let e=U[U.length-1];ee.threadId&&!O&&F(ee.threadId),H(n=>{var t,s;let l=n[n.length-1].assistant,a={...l,id:ee.assistantMessageId||(null==l?void 0:l.id)||(0,f.x0)(),message:ee.content,error:void 0,relevant_code:null!==(s=null===(t=ee.attachmentsCode)||void 0===t?void 0:t.map(e=>e.code))&&void 0!==s?s:[]};return[...n.slice(0,n.length-1),{user:{...e.user,id:(null==ee?void 0:ee.userMessageId)||e.user.id},assistant:a}]})},[ee,Q]);let em=(0,u.S)(()=>{N?N.scrollTo({top:N.scrollHeight,behavior:"smooth"}):window.scrollTo({top:document.body.offsetHeight,behavior:"smooth"})},100);l.useLayoutEffect(()=>{Q&&em.run()},[Q]),l.useEffect(()=>{X&&(null==U?void 0:U.length)&&H(e=>{var n,t,s;let l=e[e.length-1];return[...e.slice(0,e.length-1),{...l,assistant:{...l.assistant,id:(null===(n=l.assistant)||void 0===n?void 0:n.id)||(0,f.x0)(),message:null!==(s=null===(t=l.assistant)||void 0===t?void 0:t.message)&&void 0!==s?s:"",error:X?"401"===X.message?"Unauthorized":(0,o.Z)(X.graphQLErrors,e=>{var n;return(null===(n=e.extensions)||void 0===n?void 0:n.code)===c.ir})?"The thread has expired, please click 'Clear' and try again.":X.message||"Failed to fetch":"Failed to fetch"}}]}),(null==X?void 0:X.message)!=="Thread not found"||(null==U?void 0:U.length)||eu()},[X]);let eh=(e,n)=>{var t,s;let l=e.selectContext;n&&(l=l||e.activeContext),!function(e){if(!e)return!1;let n=e.filepath.startsWith("untitled:")&&!(0,x.U$)(e.filepath)[0];return!n}(l)&&(l=void 0);let r=l?{content:null!==(t=l.content)&&void 0!==t?t:"",filepath:l.filepath,language:l.filepath&&(0,x.U$)(l.filepath)[0]||"plaintext",gitUrl:null!==(s=null==l?void 0:l.git_url)&&void 0!==s?s:""}:null,o=n&&!!e.activeContext,c=(0,d.Z)((0,a.Z)([o&&e.activeContext,...(null==e?void 0:e.relevantContext)||[]]),i.Z),u=c.map(e=>({content:e.content,filepath:e.filepath,startLine:e.range.start})),m=e.message;return[{content:m,attachments:{code:u}},{docQuery:w?{content:m,searchPublic:!1}:null,generateRelevantQuestions:!!k,codeQuery:r}]},ex=(0,m.d)(async e=>{var n,t,s,l,a;if(Q)return;let r="",i=null==e?void 0:null===(n=e.selectContext)||void 0===n?void 0:n.content;if(i){let n=(null==e?void 0:null===(t=e.selectContext)||void 0===t?void 0:t.filepath)&&null!==(l=(0,x.U$)(null==e?void 0:null===(s=e.selectContext)||void 0===s?void 0:s.filepath)[0])&&void 0!==l?l:"";r="\n```".concat(n,"\n").concat(null!=i?i:"","\n","```","\n")}let o=G||e.activeContext,d={...e,message:e.message+r,id:null!==(a=e.id)&&void 0!==a?a:(0,f.x0)(),selectContext:e.selectContext,activeContext:Y&&o?o:void 0},c=[...U,{user:d,assistant:{id:(0,f.x0)(),message:"",error:void 0}}];H(c),K(...eh(d,Y))}),ev=e=>{var n;return null===(n=ex.current)||void 0===n?void 0:n.call(ex,e)},ef=async e=>{S?S(e,q):ev({message:e,relevantContext:q}),W([])},ep=(0,m.d)(e=>{W(n=>n.some(n=>(0,i.Z)(n,e))?n:n.concat([e]))}),eg=e=>{var n;null===(n=ep.current)||void 0===n||n.call(ep,e)};l.useEffect(()=>{P.current&&(null==y||y(U))},[U]);let ej=(0,u.S)(e=>{V(e)},300),ey=e=>{ej.run(e)};l.useImperativeHandle(n,()=>({sendUserChat:ev,stop:et,isLoading:Q,addRelevantContext:eg,focus:()=>{var e;return null===(e=B.current)||void 0===e?void 0:e.focus()},updateActiveSelection:ey}),[]),l.useEffect(()=>{Z(!0),null==b||b()},[]);let eC=I?"max-w-".concat(I):"max-w-2xl";return D?(0,s.jsx)(eE.Provider,{value:{threadId:O,isLoading:Q,qaPairs:U,onNavigateToContext:C,handleMessageAction:(e,n)=>{switch(n){case"delete":er(e);break;case"regenerate":eo(e);break;case"edit":ed(e)}},onClearMessages:eu,container:N,onCopyContent:E,onApplyInEditor:L,onLookupSymbol:R,openInEditor:T,relevantContext:q,removeRelevantContext:e=>{let n=[...q];n.splice(e,1),W(n)},chatInputRef:_,activeSelection:G,supportsOnApplyInEditorV2:z},children:(0,s.jsx)("div",{className:"flex justify-center overflow-x-hidden",children:(0,s.jsxs)("div",{className:"w-full px-4 md:pl-10 md:pr-[3.75rem] ".concat(eC),children:[(0,s.jsxs)("div",{className:(0,f.cn)("pb-[200px] pt-4 md:pt-10",t),children:[(null==U?void 0:U.length)?(0,s.jsx)(eb,{messages:U,chatMaxWidthClass:eC}):(0,s.jsx)(ei,{setInput:$,chatMaxWidthClass:eC,welcomeMessage:A}),(0,s.jsx)(ea,{trackVisibility:Q})]}),(0,s.jsx)(en,{onSubmit:ef,className:(0,f.cn)("fixed inset-x-0 bottom-0",M),id:g,stop:()=>{et()},reload:ec,input:J,setInput:$,chatMaxWidthClass:eC,ref:B,chatInputRef:_})]})})}):(0,s.jsx)(p.cg,{className:"".concat(eC," mx-auto pt-4 md:pt-10")})})},90168:function(e,n,t){"use strict";t.d(n,{q:function(){return v}});var s=t(36164),l=t(3546),a=t(74630),r=t(1544),i=t(29),o=t(43739),d=t(14079);let c=o.fC,u=l.forwardRef((e,n)=>{let{className:t,...l}=e;return(0,s.jsx)(o.ck,{ref:n,className:(0,r.cn)("border-b",t),...l})});u.displayName="AccordionItem";let m=l.forwardRef((e,n)=>{let{className:t,children:l,...a}=e;return(0,s.jsxs)(o.xz,{ref:n,className:(0,r.cn)("flex flex-1 items-center justify-between py-4 font-medium transition-all hover:underline [&[data-state=open]>svg]:rotate-180",t),...a,children:[l,(0,s.jsx)(d.Z,{className:"h-4 w-4 shrink-0 transition-transform duration-200"})]})});m.displayName=o.xz.displayName;let h=l.forwardRef((e,n)=>{let{className:t,children:l,...a}=e;return(0,s.jsx)(o.VY,{ref:n,className:"overflow-hidden text-sm transition-all data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down",...a,children:(0,s.jsx)("div",{className:(0,r.cn)("pb-4 pt-0",t),children:l})})});h.displayName=o.VY.displayName;var x=t(81565);let v=(0,l.forwardRef)((e,n)=>{var t,a;let{contexts:i,clientContexts:o,className:d,triggerClassname:x,onContextClick:v,enableTooltip:p,onTooltipClick:g,highlightIndex:j,showExternalLink:b,showClientCodeIcon:y,isInEditor:C}=e,N=((null==o?void 0:o.length)||0)+i.length,w=null!==(t=null==i?void 0:i.length)&&void 0!==t?t:0,k=null!==(a=null==o?void 0:o.length)&&void 0!==a?a:0,I=w+k,[A,M]=(0,l.useState)(I<=5?"references":void 0);return((0,l.useEffect)(()=>{I<=5?M("references"):M(void 0)},[I]),0===N)?null:(0,s.jsx)(c,{type:"single",collapsible:!0,className:(0,r.cn)("bg-transparent text-foreground",d),ref:n,value:A,onValueChange:M,children:(0,s.jsxs)(u,{value:"references",className:"my-0 border-0",children:[(0,s.jsx)(m,{className:(0,r.cn)("my-0 py-2 font-semibold",x),children:(0,s.jsx)("span",{className:"mr-2",children:"Read ".concat(N," file").concat(N>1?"s":"")})}),(0,s.jsxs)(h,{className:"space-y-2",children:[null==o?void 0:o.map((e,n)=>(0,s.jsx)(f,{context:e,onContextClick:e=>null==v?void 0:v(e,!0),isHighlighted:j===n,clickable:C||!!e.git_url,showClientCodeIcon:y},"user-".concat(n))),i.map((e,n)=>(0,s.jsx)(f,{context:e,onContextClick:e=>null==v?void 0:v(e,!1),enableTooltip:p,onTooltipClick:g,showExternalLinkIcon:b,isHighlighted:j===n+((null==o?void 0:o.length)||0)},"assistant-".concat(n)))]})]})})});function f(e){var n,t,o,d,c,u,m;let{context:h,clickable:v=!0,onContextClick:f,enableTooltip:p,onTooltipClick:g,showExternalLinkIcon:j,showClientCodeIcon:b,isHighlighted:y}=e,[C,N]=(0,l.useState)(!1),w=!(0,a.Z)(null===(n=h.range)||void 0===n?void 0:n.start)&&!(0,a.Z)(null===(t=h.range)||void 0===t?void 0:t.end)&&h.range.start<h.range.end,k=h.filepath.split("/"),I=k[k.length-1],A=k.slice(0,k.length-1).join("/"),M=null==h?void 0:null===(o=h.extra)||void 0===o?void 0:o.scores;return(0,s.jsxs)(i.u,{open:C,onOpenChange:e=>{p&&M&&N(e)},delayDuration:0,children:[(0,s.jsx)(i.aJ,{asChild:!0,children:(0,s.jsx)("div",{className:(0,r.cn)("rounded-md border p-2",{"cursor-pointer hover:bg-accent":v,"cursor-default pointer-events-auto":!v,"bg-accent transition-all":y}),onClick:e=>v&&(null==f?void 0:f(h)),children:(0,s.jsxs)("div",{className:"flex items-center gap-1 overflow-hidden",children:[(0,s.jsx)(x.IconFile,{className:"shrink-0"}),(0,s.jsxs)("div",{className:"flex-1 truncate",title:h.filepath,children:[(0,s.jsx)("span",{children:I}),(null===(d=h.range)||void 0===d?void 0:d.start)&&(0,s.jsxs)("span",{className:"text-muted-foreground",children:[":",h.range.start]}),w&&(0,s.jsxs)("span",{className:"text-muted-foreground",children:["-",h.range.end]}),(0,s.jsx)("span",{className:"ml-2 text-xs text-muted-foreground",children:A})]}),b&&(0,s.jsx)(x.IconFileSearch2,{className:"shrink-0 text-muted-foreground"}),j&&(0,s.jsx)(x.IconExternalLink,{className:"shrink-0 text-muted-foreground"})]})})}),(0,s.jsx)(i._v,{align:"start",onClick:g,className:"cursor-pointer p-2",children:(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"mb-2 font-semibold",children:"Scores"}),(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsxs)("div",{className:"flex",children:[(0,s.jsx)("span",{className:"w-20",children:"rrf:"}),null!==(c=null==M?void 0:M.rrf)&&void 0!==c?c:"-"]}),(0,s.jsxs)("div",{className:"flex",children:[(0,s.jsx)("span",{className:"w-20",children:"bm25:"}),null!==(u=null==M?void 0:M.bm25)&&void 0!==u?u:"-"]}),(0,s.jsxs)("div",{className:"flex",children:[(0,s.jsx)("span",{className:"w-20",children:"embedding:"}),null!==(m=null==M?void 0:M.embedding)&&void 0!==m?m:"-"]})]})]})})]})}v.displayName="CodeReferences"},73033:function(e,n,t){"use strict";t.d(n,{s:function(){return r}});var s=t(36164),l=t(3546),a=t(52991);let r=(0,l.memo)(e=>(0,s.jsx)(a.D,{linkTarget:"_blank",...e}),(e,n)=>e.children===n.children&&e.className===n.className)},83171:function(e,n,t){"use strict";t.d(n,{p:function(){return o},t:function(){return d}});var s=t(36164);t(3546);var l=t(68035),a=t(18500),r=t(1544),i=t(81565);function o(e){let{kind:n,label:t,className:a}=e;return(0,s.jsxs)(l.T5,{as:"span",className:(0,r.cn)("source-mention rounded-sm px-1",a),children:[(0,s.jsx)(c,{kind:n,className:"self-center"}),(0,s.jsx)("span",{className:"whitespace-nowrap",children:t})]})}function d(e){let{kind:n,label:t,id:l}=e.node.attrs;return(0,s.jsx)(o,{kind:n,label:t,id:l})}function c(e){let{kind:n,...t}=e;switch(n){case a.ri.Doc:return(0,s.jsx)(i.IconEmojiBook,{...t});case a.ri.Web:return(0,s.jsx)(i.IconEmojiGlobe,{...t});case a.ri.Git:return(0,s.jsx)(i.IconCode,{...t});case a.ri.Github:return(0,s.jsx)(i.IconGitHub,{...t});case a.ri.Gitlab:return(0,s.jsx)(i.IconGitLab,{...t});default:return null}}},21540:function(e,n,t){"use strict";t.d(n,{mE:function(){return D},JG:function(){return z},V$:function(){return U}});var s=t(36164),l=t(3546),a=t(42891),r=t.n(a),i={src:"/_next/static/media/default-favicon.a2df8fbb.png",height:16,width:16,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAYAAADED76LAAABAElEQVR42mOAAqaMgrXeIYlL2jwjF7WZey7wBolB5eyZotNX1PdMO/Br466r/89dfvx/w7aLv6LSlteDFem5zPPesPXir20Hbv7ftPfGrz9///969urL/xkLj/0KjlvqzZCct6rt9r3X/w+cvP/r8fOP/0Hg/uN3vzbsvPq/rmVzG0Nk+oq2J8/f///89devOw/f/n/7/uv/T19+/Dpx7uH/3NK1bQwMarO8tu66/Auk89qd17/mrzn/682H7//3H7rxi4FhsheDDYMhU0DC0vqde6/+On/lyf/5q878X7Tq9M+E7JX1cJ/4MpgzMajO9ApNXtoWl7mszc5nvhdMEgB1uZJfA01kRAAAAABJRU5ErkJggg==",blurWidth:8,blurHeight:8},o=t(62226),d=t.n(o),c=t(6797),u=t.n(c),m=t(1853),h=t(74630),x=t(66686),v=t(36982),f=t(93668),p=t(1544),g=t(90615),j=t(73033);t(80804);var b=t(74038),y=t(83171),C=t(63795),N=t(81565),w=t(3448),k=t(94744),I=t(37064),A=t(83008),M=t(28312),E=t(31458),S=t(29);let L=(0,l.memo)(e=>{let{language:n,value:t,onCopyContent:a,onApplyInEditor:r,canWrapLongLines:i,supportsOnApplyInEditorV2:o}=e,[d,c]=(0,l.useState)(!1),{isCopied:u,copyToClipboard:m}=(0,M.m)({timeout:2e3,onCopyContent:a});return(0,s.jsxs)("div",{className:"codeblock relative w-full bg-zinc-950 font-sans",children:[(0,s.jsxs)("div",{className:"flex w-full items-center justify-between bg-zinc-800 px-6 py-2 pr-4 text-zinc-100",children:[(0,s.jsx)("span",{className:"text-xs lowercase",children:n}),(0,s.jsxs)("div",{className:"flex items-center space-x-1",children:[i&&(0,s.jsxs)(S.u,{children:[(0,s.jsx)(S.aJ,{asChild:!0,children:(0,s.jsx)(E.z,{size:"icon",variant:"ghost",className:"text-xs hover:bg-[#3C382F] hover:text-[#F4F4F5] focus-visible:ring-1 focus-visible:ring-slate-700 focus-visible:ring-offset-0",onClick:()=>c(!d),children:d?(0,s.jsx)(N.IconAlignJustify,{}):(0,s.jsx)(N.IconWrapText,{})})}),(0,s.jsx)(S._v,{children:(0,s.jsx)("p",{className:"m-0",children:"Toggle word wrap"})})]}),o&&r&&(0,s.jsxs)(S.u,{children:[(0,s.jsx)(S.aJ,{asChild:!0,children:(0,s.jsxs)(E.z,{variant:"ghost",size:"icon",className:"text-xs hover:bg-[#3C382F] hover:text-[#F4F4F5] focus-visible:ring-1 focus-visible:ring-slate-700 focus-visible:ring-offset-0",onClick:()=>r(t,{languageId:n,smart:!0}),children:[(0,s.jsx)(N.IconSmartApplyInEditor,{}),(0,s.jsx)("span",{className:"sr-only",children:"Smart Apply in Editor"})]})}),(0,s.jsx)(S._v,{children:(0,s.jsx)("p",{className:"m-0",children:"Smart Apply in Editor"})})]}),r&&(0,s.jsxs)(S.u,{children:[(0,s.jsx)(S.aJ,{asChild:!0,children:(0,s.jsxs)(E.z,{variant:"ghost",size:"icon",className:"text-xs hover:bg-[#3C382F] hover:text-[#F4F4F5] focus-visible:ring-1 focus-visible:ring-slate-700 focus-visible:ring-offset-0",onClick:()=>r(t,void 0),children:[(0,s.jsx)(N.IconApplyInEditor,{}),(0,s.jsx)("span",{className:"sr-only",children:"Apply in Editor"})]})}),(0,s.jsx)(S._v,{children:(0,s.jsx)("p",{className:"m-0",children:"Apply in Editor"})})]}),(0,s.jsxs)(S.u,{children:[(0,s.jsx)(S.aJ,{asChild:!0,children:(0,s.jsxs)(E.z,{variant:"ghost",size:"icon",className:"text-xs hover:bg-[#3C382F] hover:text-[#F4F4F5] focus-visible:ring-1 focus-visible:ring-slate-700 focus-visible:ring-offset-0",onClick:()=>{u||m(t)},children:[u?(0,s.jsx)(N.IconCheck,{}):(0,s.jsx)(N.IconCopy,{}),(0,s.jsx)("span",{className:"sr-only",children:"Copy"})]})}),(0,s.jsx)(S._v,{children:(0,s.jsx)("p",{className:"m-0",children:"Copy"})})]})]})]}),(0,s.jsx)(k.Z,{language:"toml"===n?"bash":n,style:A.RY,PreTag:"div",showLineNumbers:!0,wrapLongLines:d,customStyle:{margin:0,width:"100%",background:"transparent",padding:"1.5rem 1rem"},codeTagProps:{style:{fontSize:"0.9rem",fontFamily:"var(--font-mono)"}},renderer:e=>{let{rows:n,stylesheet:t,useInlineStyles:s}=e;return n.map((e,n)=>{let l=e.children,a=null==l?void 0:l.shift();return a&&(e.children=[a,{children:l,properties:{className:[]},tagName:"span",type:"element"}]),(0,I.ZP)({node:e,stylesheet:t,useInlineStyles:s,key:n})})},children:t})]})});L.displayName="CodeBlock";let R=(0,l.createContext)({});function T(e){var n;let{inline:t,className:a,children:r,...i}=e,{lookupSymbol:o,openInEditor:d,canWrapLongLines:c,onApplyInEditor:u,onCopyContent:m,supportsOnApplyInEditorV2:h,symbolPositionMap:x}=(0,l.useContext)(R),v=null===(n=r[0])||void 0===n?void 0:n.toString(),f=v?x.get(v):void 0;if((0,l.useEffect)(()=>{t&&o&&v&&o(v)},[t,v,o]),r.length){if("▍"===r[0])return(0,s.jsx)("span",{className:"mt-1 animate-pulse cursor-default",children:"▍"});r[0]=r[0].replace("`▍`","▍")}if(t){let e=!!(null==f?void 0:f.target);return(0,s.jsxs)("code",{className:(0,p.cn)("group/symbol",a,{symbol:!!o,"bg-muted leading-5 py-0.5":!!o&&!e,"space-x-1 cursor-pointer hover:bg-muted/50 border whitespace-nowrap align-middle py-0.5":e}),onClick:()=>{e&&d&&(null==f?void 0:f.target)&&d(f.target)},...i,children:[e&&(0,s.jsx)(N.IconSquareChevronRight,{className:"relative -top-px inline-block h-3.5 w-3.5 text-primary"}),(0,s.jsx)("span",{className:(0,p.cn)("whitespace-normal",{"group-hover/symbol:text-primary":e}),children:r})]})}let g=/language-(\w+)/.exec(a||"");return(0,s.jsx)(L,{language:g&&g[1]||"",value:String(r).replace(/\n$/,""),onApplyInEditor:u,onCopyContent:m,canWrapLongLines:c,supportsOnApplyInEditorV2:h})}let _=e=>{let n=d().sanitize(e,{ALLOWED_TAGS:[],ALLOWED_ATTR:[]}),t=x.TU.parse(n),s=u().decode(t),l=s.replace(/<\/?[^>]+(>|$)/g,"");return l};function z(e){let{message:n,headline:t=!1,attachmentDocs:a,attachmentClientCode:r,attachmentCode:i,onApplyInEditor:o,onCopyContent:d,contextInfo:c,fetchingContextInfo:u,className:x,canWrapLongLines:g,onLookupSymbol:y,openInEditor:C,supportsOnApplyInEditorV2:N,activeSelection:w,...k}=e,[I,A]=(0,l.useState)(new Map),M=(0,l.useMemo)(()=>{var e,n,t;let s=null!==(e=null==a?void 0:a.map(e=>({type:"doc",data:e})))&&void 0!==e?e:[],l=null!==(n=null==r?void 0:r.map(e=>({type:"code",data:e})))&&void 0!==n?n:[],o=null!==(t=null==i?void 0:i.map(e=>({type:"code",data:e})))&&void 0!==t?t:[];return(0,m.Z)([...s,...l,...o])},[a,r,i]),E=e=>{let n;let l=[],a=0,r=e=>{e&&l.push(e)},i=(t,i,o)=>{for(;null!==(n=t.exec(e));)r(e.slice(a,n.index)),l.push((0,s.jsx)(i,{...o(n)},n.index)),a=n.index+n[0].length};return i(b.H,Z,e=>{let n=parseInt(e[1],10),t=(0,h.Z)(n)?void 0:null==M?void 0:M[n-1],s=null==t?void 0:t.type,l=t&&!(0,h.Z)(n);return{citationIndex:n,showcitation:l,citationType:s,citationSource:t}}),i(b.z,O,e=>{let n=e[1];return{sourceId:n,className:t?"text-[1rem] font-semibold":void 0}}),r(e.slice(a)),l},S=async e=>{if(!y||I.has(e))return;A(n=>new Map(n.set(e,void 0)));let n=[];if(w){let e;e=w.git_url.length>1&&!w.filepath.includes(":")?{kind:"git",filepath:w.filepath,gitUrl:w.git_url}:{kind:"uri",uri:w.filepath},n.push({filepath:e,location:{start:w.range.start,end:w.range.end}})}let t=await y(e,n);A(n=>new Map(n.set(e,t)))};return(0,s.jsx)(R.Provider,{value:{onCopyContent:d,onApplyInEditor:o,onCodeCitationClick:k.onCodeCitationClick,onCodeCitationMouseEnter:k.onCodeCitationMouseEnter,onCodeCitationMouseLeave:k.onCodeCitationMouseLeave,contextInfo:c,fetchingContextInfo:!!u,canWrapLongLines:!!g,supportsOnApplyInEditorV2:N,activeSelection:w,symbolPositionMap:I,lookupSymbol:y?S:void 0,openInEditor:C},children:(0,s.jsx)(j.s,{className:(0,p.cn)("message-markdown prose max-w-none break-words dark:prose-invert prose-p:leading-relaxed prose-pre:mt-1 prose-pre:p-0",{"cursor-default":!!o},x),remarkPlugins:[v.Z,f.Z],components:{p(e){let{children:n}=e;return(0,s.jsx)("p",{className:"mb-2 last:mb-0",children:n.map((e,n)=>"string"==typeof e?E(e):(0,s.jsx)("span",{children:e},n))})},li(e){let{children:n}=e;return n&&n.length?(0,s.jsx)("li",{children:n.map((e,n)=>"string"==typeof e?E(e):(0,s.jsx)("span",{children:e},n))}):(0,s.jsx)("li",{children:n})},code(e){let{node:n,inline:t,className:l,children:a,...r}=e;return(0,s.jsx)(T,{node:n,inline:t,className:l,...r,children:a})}},children:n})})}function D(e){let{error:n="Failed to fetch"}=e,t=(0,l.useMemo)(()=>"```\n"+JSON.stringify({error:!0,message:n},null,2)+"\n```",[n]);return(0,s.jsx)(j.s,{className:"prose-full-width prose break-words text-sm dark:prose-invert prose-p:leading-relaxed prose-pre:mt-1 prose-pre:p-0",remarkPlugins:[v.Z,f.Z],components:{code(e){let{node:n,inline:t,className:l,children:a,...r}=e;return(0,s.jsx)("div",{...r,className:(0,p.cn)(l,"bg-zinc-950 p-2"),children:a})}},children:t})}function Z(e){let{citationIndex:n,showcitation:t,citationType:l,citationSource:a}=e;return(0,s.jsx)("div",{className:"inline",children:t&&(0,s.jsx)(s.Fragment,{children:"doc"===l?(0,s.jsx)(F,{relevantDocument:a.data,citationIndex:n}):"code"===l?(0,s.jsx)(P,{relevantCode:a.data,citationIndex:n}):null})})}function O(e){var n;let{sourceId:t,className:a}=e,{contextInfo:r,fetchingContextInfo:i}=(0,l.useContext)(R);if(!t)return null;let o=null==r?void 0:null===(n=r.sources)||void 0===n?void 0:n.find(e=>e.sourceId===t);return o?(0,s.jsx)("span",{className:"node-mention",children:(0,s.jsx)("span",{children:i?(0,s.jsx)(w.O,{className:"w-16"}):(0,s.jsx)(y.p,{id:o.sourceId,label:o.sourceName,kind:o.sourceKind,className:a})})}):null}function F(e){let{relevantDocument:n,citationIndex:t}=e,l=n?new URL(n.link):null,a=(null==n?void 0:n.__typename)==="MessageAttachmentIssueDoc",r=(null==n?void 0:n.__typename)==="MessageAttachmentPullDoc";return(0,s.jsxs)(g.zs,{children:[(0,s.jsx)(g.Yi,{children:(0,s.jsx)("span",{className:"relative -top-2 mr-0.5 inline-block h-4 w-4 cursor-pointer rounded-full bg-muted text-center text-xs font-medium",onClick:()=>window.open(n.link),children:t})}),(0,s.jsx)(g.bZ,{className:"w-96 text-sm",children:(0,s.jsxs)("div",{className:"flex w-full flex-col gap-y-1",children:[(0,s.jsxs)("div",{className:"m-0 flex items-center space-x-1 text-xs leading-none text-muted-foreground",children:[(0,s.jsx)(U,{hostname:l.hostname,className:"m-0 mr-1 leading-none"}),(0,s.jsx)("p",{className:"m-0 leading-none",children:l.hostname})]}),(0,s.jsx)("p",{className:"m-0 cursor-pointer font-bold leading-none transition-opacity hover:opacity-70",onClick:()=>window.open(n.link),children:n.title}),(0,s.jsxs)("div",{className:"mb-2 w-auto",children:[a&&(0,s.jsx)(H,{closed:n.closed}),r&&(0,s.jsx)(J,{merged:n.merged})]}),(0,s.jsx)("p",{className:"m-0 line-clamp-4 leading-none",children:_((0,p.L5)(n))})]})})]})}function P(e){let{relevantCode:n,citationIndex:t}=e,{onCodeCitationClick:a,onCodeCitationMouseEnter:r,onCodeCitationMouseLeave:i}=(0,l.useContext)(R);return(0,s.jsx)("span",{className:"relative -top-2 mr-0.5 inline-block h-4 w-4 cursor-pointer rounded-full bg-muted text-center text-xs font-medium",onClick:()=>{null==a||a(n)},onMouseEnter:()=>{null==r||r(t)},onMouseLeave:()=>{null==i||i(t)},children:t})}function U(e){let{hostname:n,className:t}=e,[a,o]=(0,l.useState)(!1);return(0,s.jsxs)("div",{className:"relative h-3.5 w-3.5 shrink-0",children:[(0,s.jsx)(r(),{src:i,alt:n,width:14,height:14,className:(0,p.cn)("absolute left-0 top-0 z-0 h-3.5 w-3.5 rounded-full leading-none",t)}),(0,s.jsx)(r(),{src:"https://s2.googleusercontent.com/s2/favicons?sz=128&domain_url=".concat(n),alt:n,width:14,height:14,className:(0,p.cn)("relative z-10 h-3.5 w-3.5 rounded-full bg-card leading-none",t,{"opacity-0":!a}),onLoad:()=>{o(!0)}})]})}function H(e){let{closed:n}=e;return(0,s.jsxs)(C.C,{variant:n?"default":"secondary",className:"gap-1 py-1 text-xs",children:[n?(0,s.jsx)(N.IconCheckCircled,{className:"h-3.5 w-3.5"}):(0,s.jsx)(N.IconCircleDot,{className:"h-3.5 w-3.5"}),n?"Closed":"Open"]})}function J(e){let{merged:n}=e;return(0,s.jsxs)(C.C,{variant:n?"default":"secondary",className:"gap-1 py-1 text-xs",children:[n?(0,s.jsx)(N.IconGitMerge,{className:"h-3.5 w-3.5"}):(0,s.jsx)(N.IconGitPullRequest,{className:"h-3.5 w-3.5"}),n?"Merged":"Open"]})}},63795:function(e,n,t){"use strict";t.d(n,{C:function(){return i}});var s=t(36164);t(3546);var l=t(14375),a=t(1544);let r=(0,l.j)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",successful:"border-transparent bg-successful text-successful-foreground hover:bg-successful/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function i(e){let{className:n,variant:t,...l}=e;return(0,s.jsx)("div",{className:(0,a.cn)(r({variant:t}),n),...l})}},90615:function(e,n,t){"use strict";t.d(n,{Yi:function(){return o},bZ:function(){return d},zs:function(){return i}});var s=t(36164),l=t(3546),a=t(38421),r=t(1544);let i=a.fC,o=a.xz,d=l.forwardRef((e,n)=>{let{className:t,align:l="center",sideOffset:i=4,...o}=e;return(0,s.jsx)(a.VY,{ref:n,align:l,sideOffset:i,className:(0,r.cn)("z-50 w-64 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...o})});d.displayName=a.VY.displayName},52569:function(e,n,t){"use strict";t.d(n,{SQ:function(){return y},Yt:function(){return b},nY:function(){return j}});var s=t(36164),l=t(3546),a=t(87782),r=t(21454),i=t(36327),o=t(98454),d=t(3765),c=t(1544),u=t(66612);let m=l.forwardRef((e,n)=>{let{className:t,...l}=e;return(0,s.jsx)(u.fC,{ref:n,className:(0,c.cn)("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",t),...l})});m.displayName=u.fC.displayName;let h=l.forwardRef((e,n)=>{let{className:t,...l}=e;return(0,s.jsx)(u.Ee,{ref:n,className:(0,c.cn)("aspect-square h-full w-full",t),...l})});h.displayName=u.Ee.displayName;let x=l.forwardRef((e,n)=>{let{className:t,...l}=e;return(0,s.jsx)(u.NY,{ref:n,className:(0,c.cn)("flex h-full w-full items-center justify-center rounded-full bg-muted",t),...l})});x.displayName=u.NY.displayName;var v=t(3448),f=t(30410).lW;let p="not_found",g=new Set,j=e=>{g.delete(e),(0,r.JG)("/avatar/".concat(e))};function b(e){var n;let{user:t,className:r,fallback:o}=e,u=null==t?void 0:t.id,j=u?"/avatar/".concat(u):null,{data:b,isLoading:y,error:C}=(0,i.Z)(j,e=>{if(!(!u||g.has(u)))return(0,d.Z)(e,{responseFormatter:async e=>{let n=await e.blob(),t=f.from(await n.arrayBuffer());return"data:image/png;base64,".concat(t.toString("base64"))},errorHandler:e=>{if(404===e.status)throw Error(p)}})}),N=l.useMemo(()=>{if(null==t?void 0:t.email)return(0,a.B)(t.email)},[null==t?void 0:t.email]);return y?(0,s.jsx)(v.O,{className:(0,c.cn)("h-16 w-16 rounded-full",r)}):((null==C?void 0:C.message)===p&&u&&g.add(u),b||N||!o)?!b&&N?(0,s.jsx)(a.Z,{className:(0,c.cn)("h-16 w-16",r),...N}):(0,s.jsxs)(m,{className:(0,c.cn)("h-16 w-16",r),children:[(0,s.jsx)(h,{src:b,alt:null==t?void 0:t.email,className:"object-cover"}),(0,s.jsx)(x,{children:null==t?void 0:null===(n=t.email)||void 0===n?void 0:n.substring(0,2)})]}):o}function y(e){let[{data:n}]=(0,o.P)();return(0,s.jsx)(b,{user:null==n?void 0:n.me,...e})}},21808:function(e,n,t){"use strict";t.d(n,{$6:function(){return a},$I:function(){return r},L8:function(){return l},ir:function(){return i},o0:function(){return s}});let s="name@yourcompany.com",l=20,a={DEMO_AUTO_LOGIN:"_tabby_demo_autologin",SEARCH_INITIAL_MSG:"_tabby_search_initial_msg",SEARCH_INITIAL_CONTEXTS:"_tabby_search_initial_contexts"},r=48,i="NOT_FOUND"},12624:function(e,n,t){"use strict";t.d(n,{e:function(){return a}});var s=t(3546),l=t(62940);function a(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1?arguments[1]:void 0,[t,a]=s.useState(!1);return s.useEffect(()=>{if(n)return;let t=(0,l.Z)(()=>{a(window.innerHeight+window.scrollY>=document.body.offsetHeight-e)},100,{leading:!0});return window.addEventListener("scroll",t,{passive:!0}),window.addEventListener("resize",t,{passive:!0}),t(),()=>{window.removeEventListener("scroll",t),window.removeEventListener("resize",t)}},[e,n]),s.useEffect(()=>{if(!n)return;let t=(0,l.Z)(()=>{let{scrollTop:t,clientHeight:s,scrollHeight:l}=n;a(t+s>=l-e)},100,{leading:!0});return n.addEventListener("scroll",t,{passive:!0}),n.addEventListener("resize",t,{passive:!0}),t(),()=>{n.removeEventListener("scroll",t),n.removeEventListener("resize",t)}},[e,n]),t}},64566:function(e,n,t){"use strict";t.d(n,{x:function(){return u}});var s=t(3546),l=t(43240),a=t(11634),r=t(16784);let i=(0,l.BX)("\n  subscription CreateThreadAndRun($input: CreateThreadAndRunInput!) {\n    createThreadAndRun(input: $input) {\n      __typename\n      ... on ThreadCreated {\n        id\n      }\n      ... on ThreadUserMessageCreated {\n        id\n      }\n      ... on ThreadAssistantMessageCreated {\n        id\n      }\n      ... on ThreadRelevantQuestions {\n        questions\n      }\n      ... on ThreadAssistantMessageAttachmentsCode {\n        hits {\n          code {\n            gitUrl\n            filepath\n            language\n            content\n            startLine\n          }\n          scores {\n            rrf\n            bm25\n            embedding\n          }\n        }\n      }\n      ... on ThreadAssistantMessageAttachmentsDoc {\n        hits {\n          doc {\n            __typename\n            ... on MessageAttachmentWebDoc {\n              title\n              link\n              content\n            }\n            ... on MessageAttachmentIssueDoc {\n              title\n              link\n              body\n              closed\n            }\n            ... on MessageAttachmentPullDoc {\n              title\n              link\n              body\n              merged\n            }\n          }\n          score\n        }\n      }\n      ... on ThreadAssistantMessageContentDelta {\n        delta\n      }\n      ... on ThreadAssistantMessageCompleted {\n        id\n      }\n    }\n  }\n"),o=(0,l.BX)("\n  subscription CreateThreadRun($input: CreateThreadRunInput!) {\n    createThreadRun(input: $input) {\n      __typename\n      ... on ThreadCreated {\n        id\n      }\n      ... on ThreadUserMessageCreated {\n        id\n      }\n      ... on ThreadAssistantMessageCreated {\n        id\n      }\n      ... on ThreadRelevantQuestions {\n        questions\n      }\n      ... on ThreadAssistantMessageAttachmentsCode {\n        hits {\n          code {\n            gitUrl\n            filepath\n            language\n            content\n            startLine\n          }\n          scores {\n            rrf\n            bm25\n            embedding\n          }\n        }\n      }\n      ... on ThreadAssistantMessageAttachmentsDoc {\n        hits {\n          doc {\n            __typename\n            ... on MessageAttachmentWebDoc {\n              title\n              link\n              content\n            }\n            ... on MessageAttachmentIssueDoc {\n              title\n              link\n              body\n              closed\n            }\n            ... on MessageAttachmentPullDoc {\n              title\n              link\n              body\n              merged\n            }\n          }\n          score\n        }\n      }\n      ... on ThreadAssistantMessageContentDelta {\n        delta\n      }\n      ... on ThreadAssistantMessageCompleted {\n        id\n      }\n    }\n  }\n"),d=(0,l.BX)("\n  mutation DeleteThreadMessagePair(\n    $threadId: ID!\n    $userMessageId: ID!\n    $assistantMessageId: ID!\n  ) {\n    deleteThreadMessagePair(\n      threadId: $threadId\n      userMessageId: $userMessageId\n      assistantMessageId: $assistantMessageId\n    )\n  }\n"),c=()=>({content:"",completed:!1});function u(e){let{threadId:n,onAssistantMessageCompleted:t}=e,[l,u]=s.useState(n),m=s.useRef(),[h,x]=s.useState(!1),[v,f]=s.useState(c()),[p,g]=s.useState(),j=(e,n)=>{let t={...e};switch(n.__typename){case"ThreadCreated":t.threadId=n.id;break;case"ThreadUserMessageCreated":t.userMessageId=n.id;break;case"ThreadAssistantMessageCreated":t.assistantMessageId=n.id;break;case"ThreadRelevantQuestions":t.relevantQuestions=n.questions;break;case"ThreadAssistantMessageAttachmentsCode":t.attachmentsCode=n.hits;break;case"ThreadAssistantMessageAttachmentsDoc":t.attachmentsDoc=n.hits;break;case"ThreadAssistantMessageContentDelta":t.content+=n.delta;break;case"ThreadAssistantMessageCompleted":t.completed=!0;break;default:throw Error("Unknown event "+JSON.stringify(t))}return t},b=(0,r.d)(e=>{var n;null===(n=m.current)||void 0===n||n.call(m),m.current=void 0,x(!1),!e&&l&&(null==t||t(v))});s.useEffect(()=>{n!==l&&u(n)},[n]);let y=(e,n)=>{let{unsubscribe:t}=a.Lp.subscription(i,{input:{thread:{userMessage:e},options:n}}).subscribe(e=>{var n;if(null==e?void 0:e.error){x(!1),g(e.error),t();return}let s=null===(n=e.data)||void 0===n?void 0:n.createThreadAndRun;s&&((null==s?void 0:s.__typename)==="ThreadAssistantMessageCompleted"&&b.current(),(null==s?void 0:s.__typename)==="ThreadCreated"&&s.id!==l&&u(s.id),f(e=>j(e,s)))});return t},C=(e,n)=>{if(!l)return;let{unsubscribe:t}=a.Lp.subscription(o,{input:{threadId:l,additionalUserMessage:e,options:n}}).subscribe(e=>{var n;if(null==e?void 0:e.error){x(!1),g(e.error),t();return}let s=null===(n=e.data)||void 0===n?void 0:n.createThreadRun;s&&("ThreadAssistantMessageCompleted"===s.__typename&&b.current(),f(e=>j(e,s)))});return t},N=(0,a.Db)(d),w=(e,n)=>{h||(x(!0),g(void 0),f(c()),l?m.current=C(e,n):m.current=y(e,n))},k=(e,n,t)=>N({threadId:e,userMessageId:n,assistantMessageId:t}).then(e=>{var n;if(!(null==e?void 0:null===(n=e.data)||void 0===n?void 0:n.deleteThreadMessagePair)){if(null==e?void 0:e.error)throw e.error;throw Error("Failed to fetch")}});return{isLoading:h,answer:v,error:p,sendUserMessage:w,stop:b.current,regenerate:e=>l?(x(!0),g(void 0),f(c()),k(e.threadId,e.userMessageId,e.assistantMessageId).then(()=>{w(e.userMessage,e.threadRunOptions)}).catch(e=>{let n=e instanceof Error?e:Error("Failed to fetch");g(n),x(!1)})):Promise.resolve(void 0),deleteThreadMessagePair:k}}},47241:function(e,n,t){"use strict";t.d(n,{Eg:function(){return a},qs:function(){return r}});var s=t(17451);let l=s.a.setState,a=e=>{l(()=>({selectedModel:e}))},r=e=>{l(()=>({enableActiveSelection:e}))}},80804:function(){}}]);