(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1929],{78627:function(e,t,n){Promise.resolve().then(n.bind(n,7931))},7931:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return S}});var r=n(36164),s=n(3546),o=n(42891),i=n.n(o),a=n(11978),l=n(23342),c=n(94755),d=n(47190),u=n.n(d),m=n(42450),f=n(64148),h=n(93668),p=n(18452),g=n(74248),x=n(31458),v=n(81565),y=n(62817),w=n(73033);n(2596);let E=e=>u()(e).hsl().toString().replace(/hsla?\(/,"").replace(")","").split(",").slice(0,3).map((e,t)=>0===t?parseFloat(e).toFixed(1):e).join(""),b=["vscode"],j=["vscode"];function S(){let[e,t]=(0,s.useState)(!1),[n,o]=(0,s.useState)(null),[d,u]=(0,s.useState)(""),[S,C]=(0,s.useState)([]),[k,N]=(0,s.useState)(!1),[K,I]=(0,s.useState)(null),[M,A]=(0,s.useState)(!1),z=(0,s.useRef)(null),[L,T]=(0,s.useState)(!1),{width:_}=(0,c.iP)(),F=(0,s.useRef)(_),R=(0,a.useSearchParams)(),P=R.get("client")||void 0,W=R.get("font-size")||void 0,O=R.get("foreground")?"#".concat(R.get("foreground")):void 0,Z=R.get("background")?"#".concat(R.get("background")):void 0,B="vscode"===P,H="intellij"===P,U=b.includes(P||""),V=j.includes(P||"");(0,s.useEffect)(()=>{let e=e=>{let{data:t}=e;if(t.style){let e=t.style.split(";").filter(e=>e).map(e=>{let[t,n]=e.split(":"),r=n.trim(),s=r.startsWith("#")||r.startsWith("rgb");if(!s)return"".concat(t,": ").concat(n);let o=E(r);return"".concat(t,": ").concat(o)}).join(";");document.documentElement.style.cssText=e,N(!0)}t.themeClass&&(document.documentElement.className=t.themeClass)};return window.addEventListener("message",e),()=>{window.removeEventListener("message",e)}},[]),(0,s.useEffect)(()=>{if(!B)return;let e=e=>{(e.ctrlKey||e.metaKey)&&"KeyC"===e.code?document.execCommand("copy"):(e.ctrlKey||e.metaKey)&&"KeyX"===e.code?document.execCommand("cut"):(e.ctrlKey||e.metaKey)&&"KeyV"===e.code?document.execCommand("paste"):(e.ctrlKey||e.metaKey)&&"KeyA"===e.code&&document.execCommand("selectAll")};return window.addEventListener("keydown",e),()=>{window.removeEventListener("keydown",e)}},[]);let J=e=>{if(z.current)z.current.sendUserChat(e);else{let t=[...S];t.push(e),C(t)}},X=(0,p.H)({init:e=>{z.current||(u((0,g.x0)()),t(!0),o(e.fetcherOptions))},sendMessage:e=>J(e),showError:e=>{I(e)},cleanError:()=>{I(null)}});(0,s.useLayoutEffect)(()=>{if(L){if(_&&e&&n&&!K&&!F.current){var t;null===(t=z.current)||void 0===t||t.focus()}F.current=_}},[_,L]);let q=async()=>{A(!0),await (null==X?void 0:X.refresh()),A(!1)},D=async e=>{var t;return null==X?void 0:null===(t=X.onSubmitMessage)||void 0===t?void 0:t.call(X,e)},G=async e=>{var t;return null==X?void 0:null===(t=X.onApplyInEditor)||void 0===t?void 0:t.call(X,e)};function Q(e){let{children:t}=e;return(0,r.jsxs)("div",{className:"h-screen w-screen",style:{fontSize:k?"inherit":W,color:k?"inherit":O,background:k?"inherit":Z,padding:H?"20px":"5px 18px"},children:[(0,r.jsxs)("div",{className:"flex items-center",style:{marginBottom:"0.55em"},children:[(0,r.jsx)(i(),{src:l.Z,alt:"logo",className:"rounded-full",style:{background:"rgb(232, 226, 210)",marginRight:"0.375em",padding:"0.15em"},width:18}),(0,r.jsx)("p",{className:"font-semibold",children:"Tabby"})]}),t]})}if(K)return(0,r.jsx)(Q,{children:(0,r.jsxs)(r.Fragment,{children:[K.title&&(0,r.jsx)("p",{className:"mb-1.5 mt-2 font-semibold",children:K.title}),(0,r.jsx)(w.s,{className:"prose max-w-none break-words dark:prose-invert prose-p:leading-relaxed prose-pre:mt-1 prose-pre:p-0",remarkPlugins:[f.Z,h.Z],children:K.content}),(0,r.jsxs)(x.z,{className:"mt-5 flex items-center gap-x-2 text-sm leading-none",onClick:q,children:[M&&(0,r.jsx)(v.IconSpinner,{}),"Refresh"]})]})});if(!e||!n)return(0,r.jsx)(Q,{children:(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("p",{className:"opacity-80",children:"Welcome to Tabby Chat! Just a moment while we get things ready..."}),(0,r.jsx)(v.IconSpinner,{className:"mx-auto",style:{marginTop:"1.25em",width:"0.875em",height:"0.875em"}})]})});let Y={Authorization:"Bearer ".concat(n.authorization)};return(0,r.jsx)(m.SV,{FallbackComponent:function(e){let{error:t}=e;return(0,r.jsxs)(Q,{children:[(0,r.jsx)("p",{className:"mb-1.5 mt-2 font-semibold",children:"Something went wrong"}),(0,r.jsx)("p",{children:t.message}),(0,r.jsxs)(x.z,{className:"mt-5 flex items-center gap-x-2 text-sm leading-none",onClick:q,children:[M&&(0,r.jsx)(v.IconSpinner,{}),"Refresh"]})]})},children:(0,r.jsx)(y.e,{chatId:d,ref:z,headers:Y,onThreadUpdates:()=>{},onNavigateToContext:(e,t)=>{null==X||X.navigate(e,t)},onLoaded:()=>{S.forEach(J),C([]),T(!0)},maxWidth:B?"5xl":void 0,onCopyContent:"vscode"===P?e=>{parent.postMessage({action:"copy",data:e},"*")}:void 0,client:P,onSubmitMessage:U?D:void 0,onApplyInEditor:V?G:void 0},d)})}},2596:function(){},18452:function(e,t,n){"use strict";n.d(t,{m:function(){return i},H:function(){return a}});var r=n(3546),s=n(89704),o=n(95686);function i(e,t){let[n,o]=(0,r.useState)(null),i=!1;return(0,r.useEffect)(()=>{if(e.current&&!i){var n;i=!0,o((n=e.current,(0,s.K)(n,{expose:{navigate:t.navigate,refresh:t.refresh,onSubmitMessage:t.onSubmitMessage,onApplyInEditor:t.onApplyInEditor}})))}},[e.current]),n}function a(e){let[t,n]=(0,r.useState)(null),s=!1;return(0,r.useEffect)(()=>{let t=window.self!==window.top;t&&!s&&(s=!0,n((0,o.c)({expose:{init:e.init,sendMessage:e.sendMessage,showError:e.showError,cleanError:e.cleanError}})))},[]),t}}},function(e){e.O(0,[7998,5498,6312,7950,7980,259,2578,816,1492,4421,7590,1454,5621,4546,8746,9275,4373,5606,6193,4294,4755,2459,9736,1565,6597,6775,3375,5289,1744],function(){return e(e.s=78627)}),_N_E=e.O()}]);