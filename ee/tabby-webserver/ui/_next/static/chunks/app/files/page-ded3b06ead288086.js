(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[357],{4755:function(e,t,r){Promise.resolve().then(r.bind(r,97720))},97720:function(e,t,r){"use strict";r.r(t),r.d(t,{SourceCodeBrowser:function(){return ta},SourceCodeBrowserContext:function(){return tr}});var n=r(36164),l=r(3546),s=r(11978),a=r(57778),i=r(1853),o=r(94909),c=r(74630),d=r(26165),u=r(21454),f=r(43240),h=r(44645),m=r(80605),x=r(63484),p=r(3765),v=r(11634),g=r(70410),j=r(74248),b=r(53538),y=r(30601),N=r(90379),w=r(38736),k=r(27064),S=r(50538),C=r(42891),I=r.n(C),R=r(23342),E=r(91655),_=r(2578),O=r(93877),F=r(28312);let P=e=>{let[t,r]=(0,l.useState)(!1);return(0,l.useEffect)(()=>{let t=e.current,n=new IntersectionObserver(e=>{let[t]=e;r(t.intersectionRatio<1)},{threshold:[1]});return t&&n.observe(t),()=>{t&&n.unobserve(t)}},[e.current]),t};var D=r(31458),T=r(81565),L=r(11208),U=r(29),Z=r(70652),z=r.n(Z),M=r(48537),A=r(48048);let V=e=>{let{className:t}=e,{currentFileRoutes:r,activeRepo:s,activeEntryInfo:a}=l.useContext(tr),i=null==a?void 0:a.basename,o=l.useMemo(()=>{var e;let t=null==a?void 0:a.basename,r=[{name:null!==(e=null==a?void 0:a.repositoryName)&&void 0!==e?e:"",href:(0,A.I)(s,a.rev,"","dir")}];if(t){let e=decodeURIComponent(t).split("/")||[];for(let t=0;t<e.length;t++){let n=e.slice(0,t+1).join("/"),l=(0,A.i3)(n);r.push({name:decodeURIComponent(l),href:(0,A.I)(s,a.rev,n,"dir")})}}return r},[a,s]);return(0,n.jsxs)("div",{className:(0,j.cn)("flex flex-nowrap items-center gap-1",t),children:[(0,n.jsxs)("div",{className:"flex items-center gap-1 overflow-x-auto leading-8",children:[(0,n.jsx)(z(),{className:"cursor-pointer font-medium text-primary hover:underline",href:"/files",children:"Repositories"}),(0,n.jsx)("div",{children:"/"}),null==o?void 0:o.map((e,t)=>{let r=0===t&&(null==o?void 0:o.length)>1,s=t===o.length-1,a=(0,j.cn)("whitespace-nowrap",r||s?"font-bold":"font-medium",s?"":"cursor-pointer text-primary hover:underline",r?"hover:underline":void 0);return(0,n.jsxs)(l.Fragment,{children:[s?(0,n.jsx)("div",{className:a,children:e.name}):(0,n.jsx)(z(),{className:a,href:"/files/".concat(e.href),children:e.name}),!s&&(0,n.jsx)("div",{children:"/"})]},e.href)})]}),!!(null==r?void 0:r.length)&&!!i&&(0,n.jsx)(M.q,{className:"shrink-0",value:i})]})},H=e=>{let{blob:t,className:r,canCopy:s,hideBlobActions:a,contentLength:i,children:o,...c}=e,{chatSideBarVisible:d,setChatSideBarVisible:u,isChatEnabled:f}=l.useContext(tr),[h]=(0,O.Ds)(),m=l.useRef(null),{activePath:x}=l.useContext(tr),{isCopied:p,copyToClipboard:v}=(0,F.m)({timeout:2e3}),g=P(m),b=f&&h.value&&!d,y=i?(0,E.Z)(i):"",N=async()=>{if(!p&&t)try{let e=await t.text();v(e)}catch(e){_.A.error("Something went wrong. Please try again.")}};return(0,n.jsxs)("div",{className:(0,j.cn)("sticky -top-1 z-10 border",!g&&"rounded-t-lg",r),ref:m,...c,children:[g&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:"bg-secondary pl-4",children:(0,n.jsx)(V,{className:"py-2"})}),g&&(0,n.jsx)(L.Z,{})]}),!a&&(0,n.jsxs)("div",{className:(0,j.cn)("flex items-center justify-between bg-secondary p-2 text-secondary-foreground",!g&&"rounded-t-lg"),children:[(0,n.jsxs)("div",{className:"flex h-8 items-center gap-4 leading-8",children:[o,(0,n.jsx)("span",{className:"ml-2 text-sm text-muted-foreground",children:y})]}),(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[s&&(0,n.jsxs)(U.u,{children:[(0,n.jsx)(U.aJ,{asChild:!0,children:(0,n.jsxs)(D.z,{variant:"ghost",size:"icon",onClick:N,children:[p?(0,n.jsx)(T.IconCheck,{className:"text-green-600"}):(0,n.jsx)(T.IconCopy,{}),(0,n.jsx)("span",{className:"sr-only",children:"Copy"})]})}),(0,n.jsx)(U._v,{children:"Copy raw file"})]}),!!t&&(0,n.jsxs)(U.u,{children:[(0,n.jsx)(U.aJ,{asChild:!0,children:(0,n.jsx)("a",{className:(0,D.d)({variant:"ghost",size:"icon"}),download:(0,A.i3)(null!=x?x:""),href:URL.createObjectURL(t),children:(0,n.jsx)(T.IconDownload,{})})}),(0,n.jsx)(U._v,{children:"Download raw file"})]}),b&&(0,n.jsxs)(U.u,{children:[(0,n.jsx)(U.aJ,{asChild:!0,children:(0,n.jsxs)(D.z,{variant:"ghost",className:"flex shrink-0 items-center gap-1 px-2",onClick:e=>u(!d),children:[(0,n.jsx)(I(),{alt:"Tabby logo",src:R.Z,width:24}),"Ask Tabby"]})}),(0,n.jsx)(U._v,{children:"Open chat panel"})]})]})]})]})},Y=e=>{let{className:t,blob:r,isImage:s}=e,{activePath:a}=(0,l.useContext)(tr);return(0,n.jsx)("div",{className:(0,j.cn)(t),children:(0,n.jsx)("div",{className:"rounded-b-lg border border-t-0 p-2 text-center",children:s?(0,n.jsx)("img",{className:"mx-auto",src:r?URL.createObjectURL(r):void 0}):(0,n.jsx)("a",{className:"text-primary hover:underline",download:(0,A.i3)(null!=a?a:""),href:r?URL.createObjectURL(r):"",target:"_blank",children:"View raw"})})})},G=l.lazy(()=>Promise.all([r.e(9148),r.e(7844)]).then(r.bind(r,47844))),q=l.lazy(()=>Promise.all([r.e(5606),r.e(177),r.e(557)]).then(r.bind(r,30557))),B=e=>{var t;let{className:r}=e,{searchParams:s}=(0,h.Z)(),{activePath:a}=(0,l.useContext)(tr),{textValue:i}=(0,l.useContext)(J),o=a?(0,x.U$)(a)[0]:void 0,c=null!=o?o:"plain",d=(null===(t=s.get("plain"))||void 0===t?void 0:t.toString())==="1";return(0,n.jsx)("div",{className:(0,j.cn)(r),children:(0,n.jsx)("div",{className:"rounded-b-lg border border-t-0 py-2",children:(0,n.jsx)(l.Suspense,{fallback:(0,n.jsx)(N.cg,{className:"p-2"}),children:i&&"markdown"===c&&!d?(0,n.jsx)(q,{value:i}):(0,n.jsx)(G,{value:null!=i?i:"",language:c})})})})},J=l.createContext({}),K=e=>{var t;let{className:r,blob:s,contentLength:a,fileDisplayType:i,loading:o}=e,{searchParams:c,updateUrlComponents:d}=(0,h.Z)(),{activePath:u}=l.useContext(tr),{textValue:f}=l.useContext(J),m="raw"===i||"image"===i,p=u?(0,x.U$)(u)[0]:void 0,v=(null===(t=c.get("plain"))||void 0===t?void 0:t.toString())==="1";return(0,n.jsxs)("div",{className:(0,j.cn)(r),children:[(0,n.jsx)(H,{blob:s,contentLength:a,canCopy:!m,children:!!f&&"markdown"===(null!=p?p:"plain")&&(0,n.jsx)(S.mQ,{value:v?"1":"0",onValueChange:e=>{"1"===e?d({searchParams:{set:{plain:"1"}}}):d({searchParams:{del:"plain"}})},children:(0,n.jsxs)(S.dr,{children:[(0,n.jsx)(S.SP,{value:"0",children:"Preview"}),(0,n.jsx)(S.SP,{value:"1",children:"Code"})]})})}),o&&!s?(0,n.jsx)(N.cg,{className:"p-2"}):m?(0,n.jsx)(Y,{blob:s,isImage:"image"===i}):(0,n.jsx)(B,{})]})},W=e=>{let{blob:t,fileDisplayType:r,contentLength:s}=e,[a,i]=l.useState();return l.useEffect(()=>{let e=async e=>{try{let t=await e.text();i(t)}catch(e){i("")}};t&&"text"===r&&e(t)},[t,r]),(0,n.jsx)(J.Provider,{value:{textValue:a},children:(0,n.jsx)(K,{blob:t,fileDisplayType:r,contentLength:s})})};var $=r(826),Q=r(18452),X=r(16784),ee=r(98454),et=r(25647),er=r(17451);let en=e=>{let{className:t,...r}=e,[{data:s}]=(0,ee.P)(),{pendingEvent:a,setPendingEvent:i,repoMap:o,updateActivePath:c}=l.useContext(tr),d=(0,et.o)(er.a,e=>e.activeChatId),u=l.useRef(null),f=(0,X.d)(o),h=async e=>{if((null==e?void 0:e.filepath)&&(null==e?void 0:e.git_url)){let r=(0,j.nO)(null==e?void 0:e.range),n=f.current,l=(0,$.Z)(Object.keys(n),t=>{var r;return(null==n?void 0:null===(r=n[t])||void 0===r?void 0:r.gitUrl)===e.git_url});if(l){let s=n[l];if(s){var t;let n=(0,A.s8)(s.refs),l=null===(t=(0,A.r2)(n))||void 0===t?void 0:t.name,a=e.filepath?(0,x.U$)(e.filepath)[0]:void 0;c((0,A.I)(s,l,e.filepath,e.kind),{hash:r,replace:!1,plain:"markdown"===a&&!!r});return}}}},m=(0,Q.m)(u,{navigate:h,refresh:async()=>{window.location.reload(),await new Promise(e=>{setTimeout(()=>e(null),1e3)})}}),p=e=>{let{action:t}=e,r="";switch(t){case"explain":r="Explain the selected code:";break;case"generate_unittest":r="Generate a unit test for the selected code:";break;case"generate_doc":r="Generate documentation for the selected code:"}return r};return(l.useEffect(()=>{(null==u?void 0:u.current)&&s&&(null==m||m.init({fetcherOptions:{authorization:s.me.authToken}}))},[null==u?void 0:u.current,m,s]),l.useEffect(()=>{if(a&&m){let{lineFrom:e,lineTo:t,code:r,path:n,gitUrl:l}=a;m.sendMessage({message:p(a),selectContext:{kind:"file",content:r,range:{start:e,end:null!=t?t:e},filepath:n,git_url:l}})}i(void 0)},[a,m]),null==s?void 0:s.me)?(0,n.jsxs)("div",{className:(0,j.cn)("flex h-full flex-col",t),...r,children:[(0,n.jsx)(el,{}),(0,n.jsx)("iframe",{src:"/chat",className:"w-full flex-1 border-0",ref:u},d)]}):(0,n.jsx)(n.Fragment,{})};function el(){let{setChatSideBarVisible:e}=l.useContext(tr);return(0,n.jsx)("div",{className:"sticky top-0 flex items-center justify-end px-2 py-1",children:(0,n.jsx)(D.z,{size:"icon",variant:"ghost",onClick:t=>e(!1),children:(0,n.jsx)(T.IconClose,{})})})}var es=r(24685),ea=r(91299),ei=r(40055),eo=r(24449),ec=r(82394);let ed=e=>{var t;let{className:r}=e,a=(0,s.useRouter)(),i=(0,s.useSearchParams)(),{activeEntryInfo:o,activeRepo:c,activeRepoRef:d,updateActivePath:u}=l.useContext(tr),[f,h]=l.useState(null===(t=i.get("q"))||void 0===t?void 0:t.toString()),[m]=(0,eo.n)(f,300),x=l.useRef(null),p=null==c?void 0:c.kind,v=null==c?void 0:c.id,b=l.useMemo(()=>{if(m)return(0,ea.Z)(m.replace(/-?(f|lang):\S+\s?/g,""))},[m]),[{data:y}]=(0,ei.aM)({query:g.D7,variables:{kind:p,id:v,pattern:null!=b?b:"",rev:null==d?void 0:d.name},pause:!v||!p||!b}),N=l.useMemo(()=>{var e,t;if(!b)return[];let r=null==y?void 0:null===(e=y.repositorySearch)||void 0===e?void 0:e.slice(0,5);return null!==(t=null==r?void 0:r.map(e=>({repositorySearch:e,value:e.path,label:e.path,type:"file"})))&&void 0!==t?t:[]},[null==y?void 0:y.repositorySearch,b]),w=l.useMemo(()=>{let e=[{label:"Include only results from file path matching the given search pattern.",value:"f",type:"tips"},{label:"Exclude results from file path matching the given search pattern.",value:"-f",type:"tips"},{label:"Include only results from the given language.",value:"lang",type:"tips"},{label:"Exclude results from the given language.",value:"-lang",type:"tips"}];if(!f)return[e[0],e[2]];let t=f.match(/(^|\s)-$/),r=f.match(/(^|\s)-?f$/),n=f.match(/(^|\s)-?l(a(n(g)?)?)?$/);return t?[e[1],e[3]]:r||n?r?e.slice(0,2):n?e.slice(2):[]:[]},[f]),{isOpen:k,getMenuProps:S,getInputProps:C,highlightedIndex:I,getItemProps:R,openMenu:E}=(0,es.Kb)({items:N,onSelectedItemChange(e){let{selectedItem:t}=e;if((null==t?void 0:t.type)==="file"&&t.repositorySearch){let e=(0,A.I)(c,null==d?void 0:d.name,t.repositorySearch.path,t.repositorySearch.type);u(e);return}O(null==t?void 0:t.value)},stateReducer(e,t){let{type:r,changes:n}=t;switch(r){case es.Kb.stateChangeTypes.InputClick:return{...n,highlightedIndex:void 0,isOpen:!0};case es.Kb.stateChangeTypes.InputKeyDownArrowDown:{if(!(null==N?void 0:N.length)||!e.isOpen)return n;let t=e.highlightedIndex===N.length-1;return{...n,highlightedIndex:t?void 0:n.highlightedIndex}}case es.Kb.stateChangeTypes.InputKeyDownArrowUp:{if(!(null==N?void 0:N.length)||!e.isOpen)return n;let t=0===e.highlightedIndex;return{...n,highlightedIndex:t?void 0:n.highlightedIndex}}default:return n}}}),_=e=>{k||E(),h(e)};l.useEffect(()=>{let e=e=>{var t,r;let n=e.target,l=null==n?void 0:null===(t=n.tagName)||void 0===t?void 0:t.toLowerCase();"input"!==l&&"textarea"!==l&&"select"!==l&&"/"===e.key&&(e.preventDefault(),null===(r=x.current)||void 0===r||r.focus(),E())};return window.addEventListener("keydown",e),()=>{window.removeEventListener("keydown",e)}},[]);let O=e=>{if(!e)return;let t=(0,A.I)(c,null==o?void 0:o.rev,"","search");a.push("/files/".concat(t,"?q=").concat(encodeURIComponent(e)))},F=!(null==w?void 0:w.length)&&!(null==N?void 0:N.length);return(0,n.jsx)("div",{className:(0,j.cn)("flex w-full shrink-0 items-center bg-background px-4 py-3.5 transition duration-500 ease-in-out",r),children:(0,n.jsxs)("div",{className:(0,j.cn)("relative w-full"),children:[(0,n.jsxs)("div",{className:"h-9",children:[(0,n.jsx)("div",{className:(0,j.cn)({"absolute z-10 inset-0":k}),children:(0,n.jsx)(ec.I,{className:"w-full",...C({onKeyDown:e=>{"Enter"!==e.key||e.nativeEvent.isComposing||(e.preventDefault(),O(f))},ref:x}),value:f,onChange:e=>_(e.target.value)})}),!f&&(0,n.jsxs)("div",{className:"absolute left-3 top-1.5 cursor-text select-none text-muted-foreground",onClick:e=>{var t;e.preventDefault(),null===(t=x.current)||void 0===t||t.focus(),E()},children:["Type"," ",(0,n.jsx)("kbd",{className:"rounded border border-muted-foreground px-0.5",children:"/"})," ","to search"]})]}),(0,n.jsxs)("div",{className:"absolute right-2 top-0 z-20 flex h-full items-center",children:[f?(0,n.jsx)(D.z,{variant:"ghost",size:"icon",className:"h-6 w-6 cursor-pointer",onClick:()=>{var e;h(""),null===(e=x.current)||void 0===e||e.focus()},children:(0,n.jsx)(T.IconClose,{})}):null,(0,n.jsx)("div",{className:"z-20 ml-2 flex items-center border-l border-l-border pl-2",children:(0,n.jsx)(D.z,{variant:"ghost",className:"h-6 w-6 ",size:"icon",onClick:()=>O(f),children:(0,n.jsx)(T.IconSearch,{})})})]}),k&&(0,n.jsxs)("div",{className:(0,j.cn)("absolute -inset-x-3 -top-2.5 flex max-h-[60vh] flex-col overflow-hidden rounded-lg border bg-background p-4 shadow-2xl dark:border-2 dark:border-[#33363c] dark:bg-[hsl(0,0,13.5%)]",{"pb-0.5":F}),...S({suppressRefError:!0}),children:[(0,n.jsx)("div",{className:(0,j.cn)("shrink-0",F?"h-9":"h-12")}),(0,n.jsxs)("div",{className:"flex-1 overflow-y-auto",children:[!!(null==w?void 0:w.length)&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:"text-md mb-2 pl-2 font-semibold",children:"Narrow your search"}),(0,n.jsx)("div",{className:"space-y-2",children:w.map(e=>(0,n.jsx)(ef,{data:e},e.value))})]}),!!(null==N?void 0:N.length)&&(0,n.jsxs)(n.Fragment,{children:[!!(null==w?void 0:w.length)&&(0,n.jsx)(L.Z,{className:"my-2"}),(0,n.jsx)("div",{className:"text-md mb-1 pl-2 font-semibold",children:"Code"}),N.map((e,t)=>{var r,l;let s=e.repositorySearch,a=I===t;return(0,n.jsxs)("div",{className:(0,j.cn)("relative flex cursor-default select-none items-center gap-1 rounded-sm px-2 py-1.5 text-sm",a&&"cursor-pointer bg-accent text-accent-foreground"),...R({item:e,index:t,onMouseLeave:e=>e.preventDefault(),onMouseOut:e=>e.preventDefault()}),children:[(0,n.jsx)("div",{className:"shrink-0",children:(null==e?void 0:null===(r=e.repositorySearch)||void 0===r?void 0:r.type)==="dir"?(0,n.jsx)(T.IconDirectorySolid,{style:{color:"rgb(84, 174, 255)"}}):(0,n.jsx)(T.IconFile,{})}),(0,n.jsx)("div",{className:"flex-1 break-all",children:(0,n.jsx)(eu,{text:s.path,indices:s.indices})}),(0,n.jsx)("div",{className:"shrink-0 text-sm text-muted-foreground",children:"Jump to"})]},null===(l=e.repositorySearch)||void 0===l?void 0:l.path)})]})]})]})]})})};function eu(e){let{text:t,indices:r}=e,s=l.useMemo(()=>new Set(r),[r]);return(0,n.jsx)("p",{className:"text-muted-foreground",children:t.split("").map((e,t)=>s.has(t)?(0,n.jsx)("span",{className:"font-semibold text-foreground",children:e},"".concat(e,"_").concat(t)):e)})}function ef(e){let{data:t}=e,{label:r,value:l}=t;return(0,n.jsxs)("div",{className:"flex items-center gap-1 px-2 text-sm",children:[(0,n.jsx)(T.IconFilter,{className:"shrink-0"}),(0,n.jsxs)("div",{className:"text-secondary-foreground",children:[(0,n.jsxs)("span",{className:"mr-0.5 rounded bg-secondary px-1 py-0.5 text-secondary-foreground",children:[l,":"]}),(0,n.jsx)("span",{children:r})]})]})}var eh=r(97651),em=r.n(eh),ex=r(39018),ep=r.n(ex),ev=r(3448),eg=r(88105),ej=r(58388),eb=r(28242),ey=r(33523),eN=r(85312);let ew=eg.tk.theme({".cm-line":{cursor:"pointer"},".cm-line:hover":{opacity:"60%"}});r(55823);let ek=eg.p.mark({class:"search-match-mark"}),eS=eg.tk.theme({".search-match-mark":{backgroundColor:"hsl(var(--mark-bg))"}});function eC(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=e.state.doc,n=r.length;if(!n)return eg.p.none;let l=[];for(let e of t){let t=r.line(e.lineNumber),s=t.from,a={start:s+e.bytesStart,end:s+e.bytesEnd};try{a&&a.start<=n&&a.end<=n&&l.push(ek.range(a.start,a.end))}catch(e){}}return l.length?eg.p.set(l):eg.p.none}let eI=e=>{let t=eg.lg.fromClass(class{update(t){(t.docChanged||t.viewportChanged)&&(this.marks=eC(t.view,e))}constructor(t){this.marks=eC(t,e)}},{decorations:e=>e.marks});return[t,eS]},eR=l.memo(e=>{let t,{path:r,pattern:l}=e;if(!l)return r;let s=RegExp((0,ej.Z)(l),"gi"),a=[];for(;null!==(t=s.exec(r));){let e=t.index,r=e+t[0].length;a.push({start:e,end:r})}return(0,n.jsx)(e_,{text:r,matches:a})});eR.displayName="FilePathView";let eE=e=>{let{result:t,query:r}=e,{theme:s}=(0,eb.F)(),{activeRepo:a,activeEntryInfo:i}=l.useContext(tr),o=l.useMemo(()=>{var e;return null==r?void 0:null===(e=r.match(/f:(\S+)/))||void 0===e?void 0:e[1]},[r]),d=(0,x.U$)(t.path)[0],u=l.useMemo(()=>{var e;let r;let n=[],l=0,s=0,a=null!==(e=t.lines)&&void 0!==e?e:[];return a.forEach((e,t)=>{0===t?(l=t,s=t,r=e.lineNumber):((0,c.Z)(r)||e.lineNumber!==r+1?(r=e.lineNumber,n.push({start:l,end:s}),l=t):r=e.lineNumber,s=t)}),s!==(null==a?void 0:a.length)&&n.push({start:l,end:s}),n},[t.lines]),f="/files/".concat((0,A.I)(a,i.rev,t.path,"file"));return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:"sticky top-9 z-10 border bg-secondary p-2 text-secondary-foreground",children:(0,n.jsx)(z(),{href:{pathname:f},className:"inline-flex font-medium text-primary hover:underline",children:(0,n.jsx)(eR,{path:t.path,pattern:o})})}),(0,n.jsx)("div",{className:"divide-y-border mb-6 grid divide-y overflow-x-auto border border-t-0",children:u.map((e,r)=>{let l=t.lines.slice(e.start,e.end+1);return(0,n.jsx)(ey.Z,{offset:300,children:(0,n.jsx)(eO,{language:d,theme:s,lines:l,path:t.path})},"".concat(t.path,"-").concat(e.start))})})]})};function e_(e){let{text:t,matches:r}=e;if(!r||0===r.length)return(0,n.jsx)("span",{children:t});let l=[],s=0;return r.forEach((e,r)=>{e.start>s&&l.push((0,n.jsx)("span",{children:t.substring(s,e.start)},"text-".concat(r))),l.push((0,n.jsx)("span",{className:"bg-[hsl(var(--mark-bg))]",children:t.substring(e.start,e.end)},"match-".concat(r))),s=e.end}),s<t.length&&l.push((0,n.jsx)("span",{children:t.substring(s)},"last")),(0,n.jsx)("span",{children:l})}function eO(e){var t;let{theme:r,language:a,lines:i,path:o}=e,c=(0,s.useRouter)(),{activeRepo:d,activeEntryInfo:u}=l.useContext(tr),f=l.useMemo(()=>{var e;let t=null!==(e=null==i?void 0:i.reduce((e,t)=>e+(t.line.text||atob(t.line.base64||"")||""),""))&&void 0!==e?e:"";return t.replace(/\n$/,"")},[]),h=(null==i?void 0:null===(t=i[0])||void 0===t?void 0:t.lineNumber)||0,m=l.useMemo(()=>{if(null==i?void 0:i.length){var e;let t=[];for(let e=0;e<i.length;e++){let r=i[e];for(let n of r.subMatches)t.push({bytesStart:n.bytesStart,bytesEnd:n.bytesEnd,lineNumber:e+1})}return[(0,eg.Eu)({formatNumber(e){var t,r;return null!==(r=null===(t=i[e-1])||void 0===t?void 0:t.lineNumber.toString())&&void 0!==r?r:e}}),(e=e=>{let t="/files/".concat((0,A.I)(d,u.rev,o,"file"));c.push("".concat(t,"?plain=1#L").concat(h+e-1))},[ew,eg.tk.domEventHandlers({mousedown(t,r){let n=r.posAtCoords({x:t.clientX,y:t.clientY});if(null!=n){let l=r.state.doc.lineAt(n);e(l.number,t)}}})]),...eI(t)]}return[]},[i]);return(0,n.jsx)(eN.Z,{value:f,theme:r,language:a,readonly:!0,extensions:m})}let eF=e=>{var t,r,a;let i=(0,s.useSearchParams)(),o=null!==(r=null===(t=i.get("q"))||void 0===t?void 0:t.toString())&&void 0!==r?r:"",c=l.useMemo(()=>{var t;let r=e.results;return null!==(t=null==r?void 0:r.map(e=>({...e,blob:e.lines.reduce((e,t)=>{var r;return e+(null!==(r=t.line.text)&&void 0!==r?r:"")},"")})))&&void 0!==t?t:[]},[e.results]),d=l.useMemo(()=>{let t=0;if(!e.results)return"0";for(let r of e.results){let e=r.lines.reduce((e,t)=>{let r=t.subMatches.length;return e+r},0);t+=Math.max(e,1)}let r=t<1e3?"0":"0.0a";return ep()(t).format(r)},[e.results]),u=em().humanizer({units:["d","h","m","s"],spacer:"",maxDecimalPoints:2,language:"shortEn",languages:{shortEn:{m:()=>"m",s:()=>"s"}}})(null!==(a=e.requestDuration)&&void 0!==a?a:0);return(0,n.jsx)(n.Fragment,{children:e.loading?(0,n.jsx)(eP,{className:"mt-3"}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("h1",{className:"sticky top-0 z-20 bg-background pb-2 pt-1 font-semibold",children:[d," results in ",u]}),null==c?void 0:c.map((e,t)=>(0,n.jsx)("div",{children:(0,n.jsx)(eE,{result:e,query:o})},"".concat(e.path,"-").concat(t)))]})})};function eP(e){let{className:t}=e;return(0,n.jsxs)("div",{className:(0,j.cn)("flex flex-col gap-3",t),children:[(0,n.jsx)(ev.O,{className:"h-4 w-[20%]"}),(0,n.jsx)(ev.O,{className:"h-4 w-full"}),(0,n.jsx)(ev.O,{className:"h-8 w-full"})]})}let eD=e=>{let{className:t,error:r}=e,l=(0,n.jsx)(eL,{});switch(null==r?void 0:r.message){case A.l8.REPOSITORY_NOT_FOUND:l=(0,n.jsx)(eT,{});break;case A.l8.REPOSITORY_SYNC_FAILED:l=(0,n.jsx)(eU,{});break;case A.l8.INVALID_URL:l=(0,n.jsx)(eZ,{});break;case A.l8.FAILED_TO_FETCH:l=(0,n.jsx)(ez,{})}return(0,n.jsx)("div",{className:(0,j.cn)("flex min-h-[30vh] items-center justify-center",t),children:(0,n.jsx)("div",{className:"flex flex-col items-center gap-4",children:l})})};function eT(){return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)(T.IconFileSearch,{className:"h-6 w-6"}),(0,n.jsx)("div",{className:"text-xl font-semibold",children:"Repository not found"})]}),(0,n.jsxs)(z(),{href:"/files",className:(0,j.cn)((0,D.d)(),"gap-2"),children:[(0,n.jsx)("span",{children:"Back to repositories"}),(0,n.jsx)(T.IconArrowRight,{})]})]})}function eL(){return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)(T.IconFileSearch,{className:"h-6 w-6"}),(0,n.jsx)("div",{className:"text-xl font-semibold",children:"Not found"})]}),(0,n.jsxs)(z(),{href:"/files",className:(0,j.cn)((0,D.d)(),"gap-2"),children:[(0,n.jsx)("span",{children:"Back to repositories"}),(0,n.jsx)(T.IconArrowRight,{})]})]})}function eU(){return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)(T.IconFileSearch,{className:"h-6 w-6"}),(0,n.jsx)("div",{className:"text-xl font-semibold",children:"Repository is not cloned properly"})]}),(0,n.jsx)("div",{children:"The cloning of the repository has failed. Please verify your settings or attempt to retry the job."}),(0,n.jsxs)(z(),{href:"/settings/providers/git",className:(0,j.cn)((0,D.d)(),"gap-2"),children:[(0,n.jsx)("span",{children:"Providers Configuration"}),(0,n.jsx)(T.IconArrowRight,{})]})]})}function eZ(){return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)(T.IconFileSearch,{className:"h-6 w-6"}),(0,n.jsx)("div",{className:"text-xl font-semibold",children:"Invalid URL"})]}),(0,n.jsxs)(z(),{href:"/files",className:(0,j.cn)((0,D.d)(),"gap-2"),children:[(0,n.jsx)("span",{children:"Back to repositories"}),(0,n.jsx)(T.IconArrowRight,{})]})]})}function ez(){return(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)(T.IconFileSearch,{className:"h-6 w-6"}),(0,n.jsx)("div",{className:"text-xl font-semibold",children:"Failed to fetch"})]})})}var eM=r(76297),eA=r(36327);let eV=l.createContext({}),eH=e=>{let{onSelectTreeNode:t,children:r,activePath:l,fileMap:s,updateFileMap:a,expandedKeys:i,toggleExpandedKey:o,initialized:c,fileTreeData:d,fetchingTreeEntries:u}=e;return(0,n.jsx)(eV.Provider,{value:{onSelectTreeNode:t,fileTreeData:d,expandedKeys:i,toggleExpandedKey:o,activePath:l,fileMap:s,updateFileMap:a,initialized:c,fetchingTreeEntries:u},children:r})},eY=e=>{let{level:t}=e,r=l.useMemo(()=>Array(t).fill(1),[t]);return(0,n.jsx)("div",{className:"flex h-full shrink-0 items-stretch",children:r.map((e,t)=>(0,n.jsx)("div",{className:"flex h-8 w-2 border-r border-transparent transition-colors duration-300 group-hover/filetree:border-border"},t))})},eG=()=>{let{ref:e,entry:t,inView:r}=(0,eM.YD)({trackVisibility:!0,delay:500});return l.useEffect(()=>{if((null==t?void 0:t.target)&&!r){var e;null==t||null===(e=t.target)||void 0===e||e.scrollIntoView({block:"center"})}},[null==t?void 0:t.target]),(0,n.jsx)("div",{ref:e,className:"absolute -left-2 h-8 w-1 rounded-md bg-primary"})},eq=e=>{let{isActive:t,level:r,children:l,className:s,...a}=e;return(0,n.jsxs)("div",{className:(0,j.cn)("relative flex h-8 cursor-pointer items-stretch rounded-sm hover:bg-accent focus:bg-accent focus:text-accent-foreground",t&&"bg-accent",s),...a,children:[t&&(0,n.jsx)(eG,{}),(0,n.jsx)(eY,{level:r}),(0,n.jsxs)("div",{className:"flex flex-nowrap items-center gap-2 truncate whitespace-nowrap",children:[(0,n.jsx)("div",{className:"h-4 w-4 shrink-0"}),l]})]})},eB=e=>{let{children:t,level:r,isActive:l,className:s,...a}=e;return(0,n.jsxs)("div",{className:(0,j.cn)("relative flex cursor-pointer items-stretch rounded-sm hover:bg-accent focus:bg-accent focus:text-accent-foreground",l?"bg-accent text-accent-foreground":void 0,s),...a,children:[l&&(0,n.jsx)(eG,{}),(0,n.jsx)(eY,{level:r}),(0,n.jsx)("div",{className:"flex flex-nowrap items-center gap-2 truncate whitespace-nowrap",children:t})]})},eJ=e=>{let{node:t,level:r}=e,{activeEntryInfo:s}=l.useContext(tr),{onSelectTreeNode:a}=l.useContext(eV),i="file"===t.file.kind,o=t.fullPath===(null==s?void 0:s.basename);return(0,n.jsxs)(eq,{level:r,onClick:e=>{i&&(null==a||a(t))},isActive:o,children:[(0,n.jsx)(T.IconFile,{className:"shrink-0"}),(0,n.jsx)("div",{className:"truncate",children:null==t?void 0:t.name})]})},eK=e=>{var t,r,s;let{node:a,level:i,root:o}=e,{activeRepo:c,activeEntryInfo:d}=l.useContext(tr),{fileMap:u,updateFileMap:f,expandedKeys:h,toggleExpandedKey:m,onSelectTreeNode:x}=l.useContext(eV),v=l.useRef(!1),g=o?"":a.file.basename,j=h.has(g),b="dir"===a.file.kind&&!(null==u?void 0:null===(t=u[a.fullPath])||void 0===t?void 0:t.treeExpanded)&&j,{data:y,isLoading:N}=(0,eA.Z)(b?(0,A.Vq)(c,d.rev,g):null,p.Z,{revalidateIfStale:!1});l.useEffect(()=>{var e;if(!v.current&&(null==y?void 0:null===(e=y.entries)||void 0===e?void 0:e.length)){let e=y.entries.reduce((e,t)=>{let r=t.basename;return{...e,[r]:{file:t,name:(0,A.i3)(r),fullPath:r,treeExpanded:!1}}},{});f(e),v.current=!0}},[y]);let[w]=(0,eo.n)(N,100),k=!!(null==a?void 0:null===(r=a.children)||void 0===r?void 0:r.length);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(eB,{level:i,onClick:e=>{null==x||x(a)},isActive:(null==d?void 0:d.basename)===a.fullPath,children:[(0,n.jsx)("div",{className:"flex h-8 shrink-0 items-center hover:bg-primary/10 hover:text-popover-foreground",onClick:e=>{w||(m(a.fullPath),e.stopPropagation())},children:w&&!v.current?(0,n.jsx)(T.IconSpinner,{}):j?(0,n.jsx)(T.IconChevronDown,{}):(0,n.jsx)(T.IconChevronRight,{})}),(0,n.jsx)("div",{className:"shrink-0",style:{color:"rgb(84, 174, 255)"},children:j?(0,n.jsx)(T.IconDirectoryExpandSolid,{}):(0,n.jsx)(T.IconDirectorySolid,{})}),(0,n.jsx)("div",{className:"truncate",children:null==a?void 0:a.name})]}),(0,n.jsx)(n.Fragment,{children:j&&k?(0,n.jsx)(n.Fragment,{children:null===(s=a.children)||void 0===s?void 0:s.map(e=>{let t=e.file.basename;return"dir"===e.file.kind?(0,n.jsx)(eK,{node:e,level:i+1},t):(0,n.jsx)(eJ,{node:e,level:i+1},t)})}):null})]})},eW=()=>{let{repoMap:e,activeEntryInfo:t}=l.useContext(tr),{initialized:r,fileTreeData:s,fetchingTreeEntries:a}=l.useContext(eV),{repositorySpecifier:i}=t,o=!!i,c=o&&!(null==s?void 0:s.length);return r?o?c&&a?(0,n.jsx)(eQ,{}):(0,n.jsx)(n.Fragment,{children:null==s?void 0:s.map(e=>{var t;let r=(null==e?void 0:null===(t=e.file)||void 0===t?void 0:t.kind)==="file";return r?(0,n.jsx)(eJ,{level:0,node:e},e.fullPath):(0,n.jsx)(eK,{level:0,node:e},e.fullPath)})}):null:(0,n.jsx)(eQ,{})},e$=e=>{let{className:t,...r}=e;return(0,n.jsx)("div",{className:(0,j.cn)("group/filetree",t),children:(0,n.jsx)(eH,{...r,children:(0,n.jsx)(eW,{})})})};function eQ(){return(0,n.jsxs)("div",{className:"space-y-3 p-2",children:[(0,n.jsx)(ev.O,{}),(0,n.jsx)(ev.O,{className:"ml-4"}),(0,n.jsx)(ev.O,{className:"ml-4"}),(0,n.jsx)(ev.O,{}),(0,n.jsx)(ev.O,{className:"ml-4"})]})}var eX=r(62940),e0=r(36065),e1=r(84942),e4=r(54594),e2=r(18500);function e5(e){let{kind:t,fallback:r}=e;switch(t){case e2.vW.Git:return(0,n.jsx)(T.IconDirectorySolid,{style:{color:"rgb(84, 174, 255)"}});case e2.vW.Github:case e2.vW.GithubSelfHosted:return(0,n.jsx)(T.IconGitHub,{});case e2.vW.Gitlab:case e2.vW.GitlabSelfHosted:return(0,n.jsx)(T.IconGitLab,{});default:return null!=r?r:null}}let e8=e=>{var t,r,s,a,i;let{className:o,...d}=e,{updateActivePath:u,initialized:f,activeRepo:h,activeRepoRef:m,fileMap:x,repoMap:p,activeEntryInfo:v}=(0,l.useContext)(tr),g=l.useMemo(()=>(0,A.UR)(p).map(e=>{let t=(0,A.Pj)(e);return{repo:e,repoSpecifier:t}}),[p]),[b,y]=l.useState(!1),[N,w]=l.useState(null!==(s=null==m?void 0:m.kind)&&void 0!==s?s:"branch"),{repositoryKind:k,repositoryName:C,repositorySpecifier:I}=v,R=null==h?void 0:h.refs,E=l.useMemo(()=>(null==R?void 0:R.length)?R.map(e=>(0,A.r2)(e)):[],[R]),_=E.filter(e=>"branch"===e.kind),O=E.filter(e=>"tag"===e.kind),F=f&&!(null==g?void 0:g.length),P=e=>{var t,r,n,l,s;if((0,c.Z)(e))return;let a=null!==(l=null===(t=(0,A.r2)(e))||void 0===t?void 0:t.name)&&void 0!==l?l:"",{basename:i=""}=v,o=null!==(s=null==x?void 0:null===(n=x[i])||void 0===n?void 0:null===(r=n.file)||void 0===r?void 0:r.kind)&&void 0!==s?s:"dir";u((0,A.I)(h,a,i,o))};return(0,n.jsxs)("div",{className:(0,j.cn)(o),...d,children:[(0,n.jsx)("div",{className:"py-4 font-bold leading-8",children:(0,n.jsx)("span",{className:(0,j.cn)("py-1",{"hover:underline cursor-pointer":!!h}),onClick:()=>{h&&u((0,A.I)(h,null==v?void 0:v.rev,"","dir"))},children:"Files"})}),(0,n.jsxs)("div",{className:"space-y-3",children:[(0,n.jsxs)(e4.Ph,{disabled:!f,onValueChange:e=>{var t;let r=null===(t=g.find(t=>t.repoSpecifier===e))||void 0===t?void 0:t.repo;if(r){let t="".concat(e,"/-/tree/").concat((0,A.r2)((0,A.s8)(r.refs)).name);u(t)}},value:I,children:[(0,n.jsx)(e4.i4,{children:(0,n.jsx)(e4.ki,{asChild:!0,children:(0,n.jsxs)("div",{className:"flex items-center gap-2 overflow-hidden",children:[(0,n.jsx)("div",{className:"shrink-0",children:(0,n.jsx)(e5,{kind:k,fallback:(0,n.jsx)(T.IconFolderGit,{})})}),(0,n.jsx)("span",{className:(0,j.cn)("truncate",!C&&"text-muted-foreground"),children:C||"Pick a repository"})]})})}),(0,n.jsx)(e4.Bw,{className:"max-h-[50vh] overflow-y-auto",children:F?(0,n.jsx)(e4.Ql,{isPlaceHolder:!0,value:"",disabled:!0,children:"No repositories"}):(0,n.jsx)(n.Fragment,{children:null==g?void 0:g.map(e=>(0,n.jsx)(e4.Ql,{value:e.repoSpecifier,children:(0,n.jsxs)("div",{className:"flex items-center gap-1",children:[(0,n.jsx)(e5,{kind:e.repo.kind,fallback:(0,n.jsx)(T.IconFolderGit,{})}),e.repo.name]})},e.repoSpecifier))})})]}),!!h&&(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)(e1.J2,{open:b,onOpenChange:y,children:[(0,n.jsx)(e1.xo,{asChild:!0,children:(0,n.jsx)(D.z,{className:"w-full justify-start gap-2 px-3",variant:"outline",children:!!m&&(0,n.jsxs)(n.Fragment,{children:["tag"===m.kind?(0,n.jsx)(T.IconTag,{className:"shrink-0"}):(0,n.jsx)(T.IconGitFork,{className:"shrink-0"}),(0,n.jsx)("span",{className:"truncate",title:m.name,children:"commit"===m.kind?null===(r=m.ref)||void 0===r?void 0:null===(t=r.commit)||void 0===t?void 0:t.substring(0,7):m.name})]})})}),(0,n.jsx)(e1.yk,{className:"w-[var(--radix-popover-trigger-width)] p-0",align:"start",side:"bottom",children:(0,n.jsxs)(e0.mY,{className:"transition-all",children:[(0,n.jsx)(e0.sZ,{placeholder:"tag"===N?"Find a tag":"Find a branch"}),(0,n.jsx)(S.mQ,{className:"my-1 border-b",value:N,onValueChange:e=>w(e),children:(0,n.jsxs)(S.dr,{className:"bg-popover py-0",children:[(0,n.jsx)(S.SP,{value:"branch",children:"Branches"}),(0,n.jsx)(S.SP,{value:"tag",children:"Tags"})]})}),(0,n.jsxs)(e0.e8,{className:"max-h-[30vh]",children:[(0,n.jsx)(e0.rb,{children:"Nothing to show"}),(0,n.jsx)(e0.fu,{children:("tag"===N?O:_).map((e,t)=>{var r;return(0,n.jsxs)(e0.di,{onSelect:()=>{y(!1),P(e.ref)},children:[(0,n.jsx)(T.IconCheck,{className:(0,j.cn)("mr-2 shrink-0",(null==e?void 0:e.name)&&e.name===(null==m?void 0:m.name)?"opacity-100":"opacity-0")}),(0,n.jsx)("span",{className:"truncate",title:e.name,children:null!==(a=e.name)&&void 0!==a?a:""})]},null!==(i=null==e?void 0:null===(r=e.ref)||void 0===r?void 0:r.name)&&void 0!==i?i:t)})})]})]})})]})})]})]})},e3=e=>{let{fetchingTreeEntries:t}=e,{activePath:r,updateActivePath:s,expandedKeys:a,updateFileMap:i,toggleExpandedKey:o,initialized:c,fileTreeData:d,fileMap:u,activeRepo:f,activeEntryInfo:h}=l.useContext(tr),m=l.useRef(null),x=function(e,t){var r,n;let[s,a]=(0,l.useState)(null!==(n=null===(r=e.current)||void 0===r?void 0:r.scrollTop)&&void 0!==n?n:0);return(0,l.useEffect)(()=>{if(e.current){let r=(0,eX.Z)(()=>{var t,r;a(null!==(r=null===(t=e.current)||void 0===t?void 0:t.scrollTop)&&void 0!==r?r:0)},t,{leading:!0}),n=e.current;return n.addEventListener("scroll",r),()=>{n.removeEventListener("scroll",r)}}},[e,t]),s}(m,200);return(0,n.jsxs)("div",{className:"flex h-full flex-col overflow-hidden",children:[(0,n.jsx)(e8,{className:"shrink-0 px-4 pb-3"}),x>0&&(0,n.jsx)("div",{className:"h-0 border-b shadow-[0px_3px_8px_rgba(0,0,0,0.3)] dark:shadow-[0px_3px_8px_rgba(255,255,255,0.3)]"}),(0,n.jsx)("div",{className:"flex-1 overflow-y-auto px-4",ref:m,children:(0,n.jsx)(e$,{onSelectTreeNode:e=>{let t=(0,A.I)(f,h.rev,e.file.basename,e.file.kind);s(t)},activePath:r,fileMap:u,updateFileMap:i,expandedKeys:a,toggleExpandedKey:o,initialized:c,fileTreeData:d,fetchingTreeEntries:t})})]})};var e6=r(2899),e7=r(99047);let e9=e=>{var t,r;let{className:s,loading:a,initialized:i}=e,{activePath:c,currentFileRoutes:d,fileTreeData:u,activeRepo:f,repoMap:h,activeEntryInfo:m}=l.useContext(tr),x=l.useMemo(()=>(0,o.Z)(h)||f?function(e,t){if(!(null==e?void 0:e.length))return[];if(t){let{basename:r=""}=(0,A.Jt)(t);if(!r)return e;let n=decodeURIComponent(r).split("/"),l=e;for(let e=0;e<n.length;e++){let t=n.slice(0,e+1).join("/"),r=(0,$.Z)(l,e=>e.fullPath===t);if(null==r||!r.children)return[];l=null==r?void 0:r.children}return(null==l?void 0:l.map(e=>(0,e6.Z)(e,"children")))||[]}{let t=e.map(e=>(0,e6.Z)(e,"children"))||[];return t}}(u,c):(0,A.UR)(h).map(e=>{var t;return{file:{basename:e.name,kind:"dir"},isRepository:!0,repository:e,fullPath:(0,A.I)(e,null===(t=(0,A.r2)((0,A.s8)(e.refs)))||void 0===t?void 0:t.name,"","dir"),name:e.name}}),[u,c,f,h]),[p]=(0,eo.n)(a,300),v=!!(null==m?void 0:m.basename),g=d[(null==d?void 0:d.length)-2];return(0,n.jsxs)("div",{className:(0,j.cn)("text-base",s),children:[(0,n.jsx)(H,{blob:void 0,hideBlobActions:!0,className:"border-0"}),(!p||(null==x?void 0:x.length))&&i?(null==x?void 0:x.length)?(0,n.jsx)(e7.iA,{children:(0,n.jsxs)(e7.RM,{children:[v&&(0,n.jsx)(e7.SC,{className:"cursor-pointer",children:(0,n.jsx)(e7.pj,{className:"p-1 px-4",children:(0,n.jsx)(z(),{href:"/files/".concat((0,A.I)(f,m.rev,null==g?void 0:null===(t=g.file)||void 0===t?void 0:t.basename,null==g?void 0:null===(r=g.file)||void 0===r?void 0:r.kind)),children:(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)("div",{className:"shrink-0",children:(0,n.jsx)(T.IconDirectorySolid,{style:{color:"rgb(84, 174, 255)"}})}),(0,n.jsx)("span",{className:"px-1 py-2",children:".."})]})})})}),(0,n.jsx)(n.Fragment,{children:x.map(e=>{var t;let r=e.isRepository,l=null===(t=e.repository)||void 0===t?void 0:t.kind;return(0,n.jsx)(e7.SC,{children:(0,n.jsx)(e7.pj,{className:"p-1 px-4 text-base",children:(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)("div",{className:"shrink-0",children:r?(0,n.jsx)(e5,{kind:l,fallback:(0,n.jsx)(T.IconDirectorySolid,{style:{color:"rgb(84, 174, 255)"}})}):"dir"===e.file.kind?(0,n.jsx)(T.IconDirectorySolid,{style:{color:"rgb(84, 174, 255)"}}):(0,n.jsx)(T.IconFile,{})}),(0,n.jsx)(z(),{href:r?"/files/".concat(e.fullPath):"/files/".concat((0,A.I)(null!=f?f:e.repository,m.rev,e.file.basename,e.file.kind)),className:"cursor-pointer px-1 py-2 hover:text-primary hover:underline",children:e.name})]})})},e.fullPath)})})]})}):(0,o.Z)(h)?(0,n.jsx)("div",{className:"flex min-h-[30vh] items-center justify-center",children:(0,n.jsxs)("div",{className:"flex flex-col items-center gap-4",children:[(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)(T.IconFileSearch,{className:"h-6 w-6"}),(0,n.jsx)("div",{className:"text-xl font-semibold",children:"No repositories"})]}),(0,n.jsxs)(z(),{href:"/settings/providers/git",className:(0,j.cn)((0,D.d)(),"gap-2"),children:[(0,n.jsx)("span",{children:"Connect"}),(0,n.jsx)(T.IconArrowRight,{})]})]})}):null:(0,n.jsx)(te,{})]})};function te(){return(0,n.jsxs)("ul",{className:"space-y-3 p-2",children:[(0,n.jsx)(ev.O,{}),(0,n.jsx)(ev.O,{}),(0,n.jsx)(ev.O,{}),(0,n.jsx)(ev.O,{})]})}let tt=(0,f.BX)("\n  query RepositoryGrep($id: ID!, $kind: RepositoryKind!, $query: String!) {\n    repositoryGrep(kind: $kind, id: $id, query: $query) {\n      files {\n        path\n        lines {\n          line {\n            text\n            base64\n          }\n          byteOffset\n          lineNumber\n          subMatches {\n            bytesStart\n            bytesEnd\n          }\n        }\n      }\n      elapsedMs\n    }\n  }\n"),tr=l.createContext({}),tn=e=>{let{children:t}=e,r=(0,s.usePathname)(),{updateUrlComponents:a}=(0,h.Z)(),[o,c]=l.useState(!1),[d,u]=l.useState(),f=l.useMemo(()=>(0,A.Jt)(d),[d]),x=(0,m.xG)(),[p,v]=l.useState(!1),[g,j]=l.useState({}),[b,y]=l.useState({}),[N,w]=l.useState(new Set),[k,S]=l.useState(!1),[C,I]=l.useState(),R=l.useRef(),E=l.useCallback(async(e,t)=>{let r=null==t?void 0:t.replace;if(e){let n={},l=["redirect_filepath","redirect_git_url","line"];(null==t?void 0:t.plain)?n.plain="1":l.push("plain"),a({pathname:"/files/".concat(e),searchParams:{set:n,del:l},replace:r,hash:null==t?void 0:t.hash})}else a({pathname:"/files",searchParams:{del:["path","plain","line"]},hash:null==t?void 0:t.hash,replace:r})},[]),_=l.useMemo(()=>(function e(t){if(!t.length)return[];for(let r of(t.sort((e,t)=>{let r="file"===e.file.kind?1:0,n="file"===t.file.kind?1:0;return r-n||e.name.localeCompare(t.name)}),t))(null==r?void 0:r.children)&&e(r.children);return t})(function(e){let t=[];if(!e)return t;let r=Object.keys(e);for(let n of r){let r=e[n],l=n.split("/"),s=t;for(let e=0;e<l.length;e++){let t=l.slice(0,e+1).join("/"),a=null==s?void 0:s.find(e=>e.fullPath===t);if(a)s=a.children||[];else{let e={file:r.file,name:r.name,fullPath:n,children:[],isRepository:r.isRepository,repository:r.repository};s.push(e),s=e.children}}}return t}(g)),[g]),O=l.useMemo(()=>{let{repositoryKind:e,repositoryName:t,repositorySpecifier:r}=f;if(e&&t)return r?b[r]:void 0},[b,f]),F=l.useMemo(()=>{var e,t;if(!f||!O)return;let r=null!==(t=null==f?void 0:f.rev)&&void 0!==t?t:"",n=null===(e=O.refs)||void 0===e?void 0:e.find(e=>(null==e?void 0:e.name)==="refs/heads/".concat(r)||(null==e?void 0:e.name)==="refs/tags/".concat(r)||(null==e?void 0:e.commit)===r);if(n){let e;return n.name==="refs/heads/".concat(r)?e="branch":n.name==="refs/tags/".concat(r)?e="tag":n.commit===r&&(e="commit"),(0,A.r2)(n,e)}},[f,O]),P=l.useMemo(()=>{var e;if(!d)return[];let{basename:t=""}=f,r=[{file:{kind:"dir",basename:""},isRepository:!0,repository:O,name:null!==(e=null==O?void 0:O.name)&&void 0!==e?e:"",fullPath:""}],n=(null==t?void 0:t.split("/"))||[];for(let e=0;e<n.length;e++){let t=n.slice(0,e+1).join("/");r.push(null==g?void 0:g[t])}return(0,i.Z)(r)},[d,g,f]);return l.useEffect(()=>{var e;let t=null===(e=r.match(/^\/files\/(.*)/))||void 0===e?void 0:e[1];R.current=d,u(null!=t?t:""),o||c(!0)},[r]),(0,n.jsx)(tr.Provider,{value:{initialized:p,setInitialized:v,activePath:d,updateActivePath:E,fileMap:g,updateFileMap:(e,t)=>{e&&(t?j(e):j(t=>({...t,...e})))},expandedKeys:N,setExpandedKeys:w,toggleExpandedKey:e=>{let t=N.has(e),r=new Set(N);t?r.delete(e):r.add(e),w(r)},currentFileRoutes:P,fileTreeData:_,chatSideBarVisible:k,setChatSideBarVisible:S,pendingEvent:C,setPendingEvent:I,isChatEnabled:x,repoMap:b,setRepoMap:y,activeRepo:O,activeRepoRef:F,isPathInitialized:o,activeEntryInfo:f,prevActivePath:R},children:t})},tl="application/vnd.directory+json",ts=e=>{var t;let{className:r}=e,{activePath:s,updateActivePath:a,initialized:i,setInitialized:f,chatSideBarVisible:m,setChatSideBarVisible:v,setPendingEvent:g,repoMap:y,setRepoMap:S,activeRepo:C,isPathInitialized:I,activeEntryInfo:R,prevActivePath:E,updateFileMap:_,setExpandedKeys:O}=l.useContext(tr),{searchParams:F}=(0,h.Z)(),P=l.useRef(!1),{progress:D,setProgress:T}=(0,w.U)(),L=l.useRef(null),[U,Z]=l.useState(35),z=null===(t=F.get("q"))||void 0===t?void 0:t.toString(),M=l.useMemo(()=>(0,A.Jt)(s),[s]),H=null==M?void 0:M.basename,Y=(null==R?void 0:R.viewMode)==="blob",G=(null==R?void 0:R.viewMode)==="search",q=!!i&&!(0,o.Z)(y)&&!!s&&!G,B=!!i&&!(0,o.Z)(y)&&!!s&&G,J=!!i&&Y&&C,{data:K,isLoading:$,error:Q}=(0,u.ZP)(q?s:null,e=>{let{repositorySpecifier:t}=(0,A.Jt)(e);return tc(e,t?null==y?void 0:y[t]:void 0).then(t=>({entries:t,requestPathname:e}))},{revalidateOnFocus:!1,shouldRetryOnError:!1}),{data:X,isLoading:ee,error:et}=(0,u.ZP)(J?[(0,A.Vq)(C,R.rev,H),H]:null,e=>{let[t,r]=e;return(0,p.Z)(t,{responseFormatter:async e=>{let t=e.headers.get("Content-Type");if(t===tl)throw Error(A.l8.INVALID_URL);let n=(0,d.Z)(e.headers.get("Content-Length")),l=await e.blob(),s=await to(null!=r?r:"",l);return{contentLength:n,blob:l,fileDisplayType:s}},errorHandler(){throw Error(A.l8.NOT_FOUND)}})},{revalidateOnFocus:!1,shouldRetryOnError:!1}),{data:er,isLoading:el,error:es}=(0,u.ZP)(B&&z?[s,z]:null,e=>{let[t,r]=e,{repositorySpecifier:n}=(0,A.Jt)(t);return td(r,n?null==y?void 0:y[n]:void 0)},{revalidateOnFocus:!1,shouldRetryOnError:!1}),ea=null==X?void 0:X.blob,ei=null==X?void 0:X.contentLength,eo=null==X?void 0:X.fileDisplayType,ec=(null==R?void 0:R.viewMode)==="tree"||!(null==R?void 0:R.viewMode);return l.useEffect(()=>{let e=async()=>{if(P.current)return;P.current=!0;let e=await ti(),t=F.get("redirect_filepath"),r=F.get("redirect_git_url");if((null==e?void 0:e.length)&&t&&r){let i=e.find(e=>e.gitUrl===r);if(i){var n,l,s;let e=(0,A.s8)(i.refs),r=(null===(n=(0,A.r2)(e))||void 0===n?void 0:n.name)||"",o=(0,A.kQ)(window.location.hash),d=!(0,c.Z)(null==o?void 0:o.start),u=parseInt(null!==(s=null===(l=F.get("line"))||void 0===l?void 0:l.toString())&&void 0!==s?s:""),f=d?window.location.hash:(0,j.nO)({start:u}),h=t?(0,x.U$)(t)[0]:void 0;a((0,A.I)(i,r,t,"file"),{replace:!0,hash:f,plain:"markdown"===h&&!!f}),P.current=!1;return}}e&&S((0,A.fr)(e)),f(!0)};!i&&I&&e()},[s,i,I]),l.useEffect(()=>{if(!K)return;let{entries:e,requestPathname:t}=K,{repositorySpecifier:r,viewMode:n,basename:l,rev:s}=(0,A.Jt)(t),{repositorySpecifier:a,rev:i}=(0,A.Jt)(E.current),o=(0,A.yH)(l,"tree"===n),c={};if(e.length)for(let t of e){let e=t.basename;c[e]={file:t,name:(0,A.i3)(e),fullPath:e,treeExpanded:o.includes(t.basename)}}let d=o.filter(Boolean),u=r!==a||s!==i;c&&_(c,u),(null==d?void 0:d.length)&&(u?O(new Set(d)):O(e=>{let t=new Set(e);for(let e of d)t.add(e);return t}))},[K]),l.useEffect(()=>{!i||(!D&&(ee||$)?T(!0):ee||$||T(!1))},[ee,$]),l.useEffect(()=>{var e,t,r;m?(null===(e=L.current)||void 0===e||e.expand(),null===(t=L.current)||void 0===t||t.resize(U)):null===(r=L.current)||void 0===r||r.collapse()},[m]),l.useEffect(()=>{if(!(ee||$))return;let{repositorySpecifier:e,rev:t}=R,{repositorySpecifier:r,rev:n}=(0,A.Jt)(E.current);(e!==r||t!==n)&&(_({},!0),O(new Set))},[R]),l.useEffect(()=>{let e=e=>{v(!0),g(e)};return k.u.on("code_browser_quick_action",e),()=>{k.u.off("code_browser_quick_action",e)}},[]),(0,n.jsxs)(b.pO,{direction:"horizontal",className:(0,j.cn)(r),onLayout:e=>{(null==e?void 0:e[2])&&Z(e[2])},children:[(0,n.jsx)(b.ee,{defaultSize:20,minSize:20,maxSize:40,className:"hidden lg:block",children:(0,n.jsx)(e3,{fetchingTreeEntries:$})}),(0,n.jsx)(b.Dp,{className:"hidden w-1 bg-border/40 hover:bg-border active:bg-blue-500 lg:block"}),(0,n.jsx)(b.ee,{defaultSize:80,minSize:30,children:(0,n.jsxs)("div",{className:"flex h-full flex-col",children:[(0,n.jsx)(ed,{className:(0,j.cn)("z-40",(null==R?void 0:R.repositorySpecifier)?"block":"hidden")}),(0,n.jsxs)("div",{className:"flex h-full flex-col overflow-y-auto px-4 pb-4",children:[(ec||Y)&&(0,n.jsx)(V,{className:(0,j.cn)("pb-4",{"pt-4":!(null==R?void 0:R.repositorySpecifier)})}),i?et||Q?(0,n.jsx)(eD,{className:"rounded-lg border p-4",error:Q||et}):(0,n.jsxs)(n.Fragment,{children:[ec&&(0,n.jsx)(e9,{loading:$,initialized:i,className:"rounded-lg border"}),Y&&(0,n.jsx)(W,{blob:ea,contentLength:ei,fileDisplayType:eo,loading:ee||$}),G&&(0,n.jsx)(eF,{results:null==er?void 0:er.files,requestDuration:null==er?void 0:er.elapsedMs,loading:el})]}):(0,n.jsx)(N.cg,{className:"rounded-lg border p-4"})]})]})}),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(b.Dp,{className:(0,j.cn)("hidden w-1 bg-border/40 hover:bg-border active:bg-blue-500",m&&"block")}),(0,n.jsx)(b.ee,{collapsible:!0,collapsedSize:0,defaultSize:0,minSize:25,ref:L,onCollapse:()=>v(!1),children:(0,n.jsx)(en,{})})]})]})},ta=e=>{let[t]=(0,y.Hb)(),r=t?{height:"calc(100vh - ".concat(y.wt,")")}:{height:"100vh"};return(0,n.jsx)(tn,{children:(0,n.jsx)("div",{className:"transition-all",style:r,children:(0,n.jsx)(ts,{className:"source-code-browser",...e})})})};async function ti(){let e=v.L.createRequestOperation("query",(0,a.h)(g.zz,{}));return v.L.executeQuery(e).then(e=>{var t;return(null==e?void 0:null===(t=e.data)||void 0===t?void 0:t.repositoryList)||[]})}async function to(e,t){var r;if(!t)return;let n=null==t?void 0:t.type,l=null===(r=(0,x.U$)(e))||void 0===r?void 0:r[0];if(null==n?void 0:n.startsWith("image"))return"image";if(l||(null==n?void 0:n.startsWith("text")))return"text";let s=await new Promise((e,r)=>{let n=t.slice(0,1024),l=new FileReader;l.onloadend=function(t){var r;if((null==t?void 0:null===(r=t.target)||void 0===r?void 0:r.readyState)===FileReader.DONE){let r=t.target.result;"string"!=typeof r?e(!1):/[\x00-\x08\x0B\x0C\x0E-\x1F\x7F-\x9F]/.test(r)?e(!1):e(!0)}},l.onerror=function(){e(!1)},l.readAsText(n,"UTF-8")});return s?"text":"raw"}async function tc(e,t){if(!e)return[];if(!t)throw Error(A.l8.REPOSITORY_NOT_FOUND);if((0,o.Z)(t.refs))throw Error(A.l8.REPOSITORY_SYNC_FAILED);let{basename:r,rev:n,viewMode:l}=(0,A.Jt)(e);if(!n||!l)throw Error(A.l8.INVALID_URL);let s=(0,A.yH)(r,"tree"===l),a=s.map(e=>()=>(0,p.Z)((0,A.Vq)(t,n,e),{responseFormatter(e){let t=e.headers.get("Content-Type");if(t!==tl)throw Error(A.l8.INVALID_URL);return e.json()},errorHandler(){throw Error(A.l8.NOT_FOUND)}})),i=await Promise.all(a.map(e=>e())),c=[];for(let e of i){var d;(null==e?void 0:null===(d=e.entries)||void 0===d?void 0:d.length)&&(c=[...c,...e.entries])}return c}async function td(e,t){if(!t)throw Error(A.l8.REPOSITORY_NOT_FOUND);let r=v.L.query(tt,{id:t.id,kind:t.kind,query:e,pause:!t}).toPromise();return null==r?void 0:r.then(e=>{var t;if(null==e?void 0:e.error)throw Error(A.l8.FAILED_TO_FETCH);return null==e?void 0:null===(t=e.data)||void 0===t?void 0:t.repositoryGrep})}},48048:function(e,t,r){"use strict";r.d(t,{BX:function(){return y},I:function(){return N},Jt:function(){return f},Pj:function(){return x},UR:function(){return v},Vq:function(){return w},fr:function(){return p},i3:function(){return h},kQ:function(){return k},l8:function(){return l},r2:function(){return j},s8:function(){return b},yH:function(){return m}});var n,l,s=r(74630),a=r(5035),i=r(64220),o=r(13420),c=r(18500);(n=l||(l={})).FAILED_TO_FETCH="FAILED_TO_FETCH",n.INVALID_URL="INVALID_URL",n.NOT_FOUND="NOT_FOUND",n.REPOSITORY_NOT_FOUND="REPOSITORY_NOT_FOUND",n.REPOSITORY_SYNC_FAILED="REPOSITORY_SYNC_FAILED";let d=Object.keys(c.vW).map(e=>u(e));function u(e){return e.toLowerCase().replaceAll("_","")}function f(e){let t,r,n;let l={};if(!e)return l;let a=e.indexOf("/-/"),i=e.split("/"),u=i[0],f=d.includes(u);if(!f||-1===a)return l;let h=c.vW.Git;switch(u){case"git":h=c.vW.Git;break;case"github":h=c.vW.Github;break;case"gitlab":h=c.vW.Gitlab;break;case"githubselfhosted":h=c.vW.GithubSelfHosted;break;case"gitlabselfhosted":h=c.vW.GitlabSelfHosted}let m=e.indexOf("/-/tree/"),x=e.indexOf("/-/blob/"),p=e.indexOf("/-/search/");if(m>-1){r="tree";let l=e.slice(m+8),s=l.split("/");n=s[0],t=(0,o.Z)(s.slice(1).join("/"),"/")}if(x>-1){r="blob";let l=e.slice(x+8),s=l.split("/");n=s[0],t=(0,o.Z)(s.slice(1).join("/"),"/")}if(p>-1){r="search";let l=e.slice(p+10),s=l.split("/");n=s[0],t=""}let v=e.split("/-/")[0],g=v.split("/").slice(1).join("/");return{repositorySpecifier:e.split("/-/")[0],repositoryName:g,repositoryKind:h,rev:(0,s.Z)(n)?void 0:decodeURIComponent(n),viewMode:r,basename:(0,s.Z)(t)?void 0:decodeURIComponent(t)}}function h(e){if(!e)return"";let t=e.split("/");return t[t.length-1]}function m(e,t){if((0,s.Z)(e))return[];let r=[""],n=e.split("/"),l=t?n.length:n.length-1;for(let e=0;e<l;e++)r.push(n.slice(0,e+1).join("/"));return r}function x(e){if((null==e?void 0:e.kind)&&(null==e?void 0:e.name))return"".concat(u(e.kind),"/").concat(e.name)}function p(e){return(0,a.Z)(e,e=>"".concat(u(e.kind),"/").concat(e.name))}function v(e){let t=(0,i.Z)(e,e=>e);return t.sort((e,t)=>e.name.localeCompare(t.name)),t}function g(e){return e.split("/").map(e=>encodeURIComponent(e)).join("/")}function j(e,t){if(!e)return{name:"",ref:void 0};let r=e.name.match(/refs\/(\w+)\/(.*)/);if(r){let n="tags"===r[1]?"tag":"branch";return{kind:null!=t?t:n,name:r[2],ref:e}}return"commit"===t?{kind:t,name:e.commit,ref:e}:{name:"",ref:e}}function b(e){let t,r,n,l;for(let s of e){let{name:e}=s;"refs/heads/main"===e?t=s:"refs/heads/master"===e?r=s:!n&&e.startsWith("refs/heads/")?n=s:!l&&e.startsWith("refs/tags/")&&(l=s)}return t||r||n||l}function y(e){return"blob"===e?"file":"dir"}function N(e,t,r,n){let l=x(e);return"".concat(l,"/-/").concat("search"===n?"search":"file"===n?"blob":"tree","/").concat(encodeURIComponent(null!=t?t:""),"/").concat(g(null!=r?r:""))}function w(e,t,r){let n=null==e?void 0:e.id,l=null==e?void 0:e.kind;if(!n||!l||!t)return null;let s="".concat(u(l),"/").concat(n);return"/repositories/".concat(s,"/rev/").concat(encodeURIComponent(t),"/").concat(g(null!=r?r:""))}function k(e){if(!e)return null;let t=/^#L(\d+)(?:-L(\d+))?/.exec(e);if(!t)return null;let[,r,n]=t,l=parseInt(r),s=parseInt(n);return{start:Number.isNaN(l)?void 0:l,end:Number.isNaN(s)?void 0:s}}},27064:function(e,t,r){"use strict";r.d(t,{u:function(){return l}});var n=r(18366);let l=(0,n.Z)()},85312:function(e,t,r){"use strict";r.d(t,{Z:function(){return p}});var n=r(36164),l=r(3546),s=r(30352),a=r(94559),i=r(14679),o=r(88105),c=r(99641),d=r(21399),u=r(1853),f=r(49776);let h=[(0,o.AE)(),(0,f.sW)(),a.yy.allowMultipleSelections.of(!0),(0,s.nF)(s.R_,{fallback:!0}),(0,o.Zs)()];r(65001);let m=a.q6.define(),x=l.forwardRef((e,t)=>{let{value:r,theme:f,language:x,readonly:p=!0,extensions:v,height:g=null,width:j=null,viewDidUpdate:b}=e,y=l.useRef(!1),N=l.useRef(null),[w,k]=l.useState(null),S=o.tk.theme({"&":{height:g,width:j,outline:"none !important",background:"hsl(var(--background))"},"&.cm-focused":{outline:"none !important"},"& .cm-scroller":{height:"100% !important",outline:"none"},"& .cm-gutters":{background:"hsl(var(--background))"},"&.cm-focused .cm-selectionLayer .cm-selectionBackground":{backgroundColor:"hsl(var(--cm-selection-bg)) !important"},".cm-selectionLayer .cm-selectionBackground":{backgroundColor:"hsl(var(--cm-selection-bg)) !important"}}),C=[S,h,o.tk.baseTheme({".cm-scroller":{fontSize:"14px"},".cm-gutters":{backgroundColor:"transparent",borderRight:"none"}}),a.yy.readOnly.of(p)],I=e=>"graphql"===e?new s.ri(d.Wf):(0,c.vf)(function(e,t){switch(e){case"javascript-typescript":return"tsx";case"shellscript":case"bash":return"shell";default:return e}}(e)),R=()=>{let e=(0,u.Z)([...C,I(x)]);return"dark"===f?(e.push(i.pD),e.push((0,s.nF)(i.VE))):e.push((0,s.nF)(s.R_)),Array.isArray(v)&&(e=e.concat(v)),e};return l.useEffect(()=>{(()=>{if(!y.current&&N.current){y.current=!0;let e=a.yy.create({doc:r,extensions:R()}),t=new o.tk({state:e,parent:N.current});k(t)}})()},[]),l.useEffect(()=>{w&&w.dispatch({effects:a.Py.reconfigure.of(R())})},[g,j,f,x,v]),l.useEffect(()=>{(()=>{if(void 0===r||!w)return;let e=w?w.state.doc.toString():"";w&&r!==e&&w.dispatch({changes:{from:0,to:e.length,insert:r||""},annotations:[m.of(!0)]})})()},[r]),l.useEffect(()=>()=>{w&&(w.destroy(),k(null))},[]),l.useEffect(()=>{null==b||b(w)},[w]),l.useImperativeHandle(t,()=>({getView:()=>w}),[w]),(0,n.jsx)("div",{className:"codemirror-editor h-full",ref:N})});x.displayName="CodeMirrorEditor";var p=x},30601:function(e,t,r){"use strict";r.d(t,{Hb:function(){return h},wt:function(){return d},xc:function(){return m},yo:function(){return f}});var n=r(36164),l=r(3546),s=r(74630),a=r(36327),i=r(80605),o=r(74248),c=r(81565);let d="3.5rem",u=l.createContext({}),f=e=>{let{children:t}=e,r=(0,i.UA)(),[a,o]=l.useState(!1);return l.useEffect(()=>{let e=window.self!==window.top;e||(0,s.Z)(r)||o(r)},[r]),(0,n.jsx)(u.Provider,{value:{isShowDemoBanner:a,setIsShowDemoBanner:o},children:t})};function h(){let{isShowDemoBanner:e,setIsShowDemoBanner:t}=l.useContext(u);return[e,t]}function m(){let[e,t]=h(),{data:r}=(0,a.Z)("https://api.github.com/repos/TabbyML/tabby",e=>fetch(e).then(e=>e.json()));return(0,n.jsxs)("div",{className:(0,o.cn)("flex items-center justify-between bg-primary px-4 text-primary-foreground transition-all md:px-5",{"opacity-100 pointer-events-auto":e,"opacity-0 pointer-events-none":!e}),style:e?{height:d}:{height:0},children:[(0,n.jsxs)("a",{href:"https://links.tabbyml.com/schedule-a-demo",target:"_blank",className:"flex items-center gap-x-2 text-xs font-semibold underline md:text-sm",children:[(0,n.jsx)("span",{children:"\uD83D\uDCC6"}),(0,n.jsx)("span",{children:"Book a 30-minute product demo."})]}),(0,n.jsxs)("div",{className:"flex items-center gap-x-4 md:gap-x-8",children:[(0,n.jsxs)("a",{href:"https://github.com/TabbyML/tabby",target:"_blank",className:"flex items-center transition-all hover:opacity-70",children:[(0,n.jsx)(c.IconGithub,{}),(0,n.jsxs)("div",{className:"ml-2 hidden md:block",children:[(0,n.jsx)("p",{className:"text-xs font-semibold",children:"TabbyML/tabby"}),(0,n.jsxs)("div",{className:(0,o.cn)("flex items-center text-xs transition-all",{"h-4 opacity-70":r,"h-0 opacity-0":!r}),children:[(0,n.jsx)(c.IconStar,{className:"mr-1 h-2.5 w-2.5"}),(0,n.jsx)("span",{children:null==r?void 0:r.stargazers_count}),(0,n.jsx)(c.IconGitFork,{className:"ml-2 mr-1 h-2.5 w-2.5"}),(0,n.jsx)("span",{children:null==r?void 0:r.forks_count})]})]})]}),(0,n.jsx)(c.IconClose,{className:"cursor-pointer transition-all hover:opacity-70",onClick:()=>t(!1)})]})]})}},38736:function(e,t,r){"use strict";r.d(t,{J:function(){return u},U:function(){return f}});var n=r(36164),l=r(3546),s=r(7062),a=r.n(s),i=r(9010),o=r(24449),c=r(16784);let d=l.createContext({}),u=e=>{let{children:t}=e,{theme:r}=(0,i.X)(),[s,u]=l.useState(!1),[f]=(0,o.n)(s,200,{leading:!0}),h=(0,c.d)(s);l.useEffect(()=>{a().config({barColors:{0:"dark"===r?"#DC981A":"#B7942B"}})},[]);let m=l.useCallback(e=>{e&&e===h.current||u(e)},[]);return(0,n.jsxs)(d.Provider,{value:{progress:f,setProgress:m},children:[f&&(0,n.jsx)(a(),{}),t]})},f=()=>l.useContext(d)},36065:function(e,t,r){"use strict";r.d(t,{di:function(){return m},e8:function(){return d},fu:function(){return f},mY:function(){return o},rb:function(){return u},sZ:function(){return c},zz:function(){return h}});var n=r(36164),l=r(3546),s=r(53241),a=r(93170),i=r(74248);r(30220);let o=l.forwardRef((e,t)=>{let{className:r,...l}=e;return(0,n.jsx)(s.mY,{ref:t,className:(0,i.cn)("flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground",r),...l})});o.displayName=s.mY.displayName;let c=l.forwardRef((e,t)=>{let{className:r,...l}=e;return(0,n.jsxs)("div",{className:"flex items-center border-b px-3","cmdk-input-wrapper":"",children:[(0,n.jsx)(a.Z,{className:"mr-2 h-4 w-4 shrink-0 opacity-50"}),(0,n.jsx)(s.mY.Input,{ref:t,className:(0,i.cn)("flex h-11 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50",r),...l})]})});c.displayName=s.mY.Input.displayName;let d=l.forwardRef((e,t)=>{let{className:r,...l}=e;return(0,n.jsx)(s.mY.List,{ref:t,className:(0,i.cn)("max-h-[300px] overflow-y-auto overflow-x-hidden",r),...l})});d.displayName=s.mY.List.displayName;let u=l.forwardRef((e,t)=>(0,n.jsx)(s.mY.Empty,{ref:t,className:"py-6 text-center text-sm",...e}));u.displayName=s.mY.Empty.displayName;let f=l.forwardRef((e,t)=>{let{className:r,...l}=e;return(0,n.jsx)(s.mY.Group,{ref:t,className:(0,i.cn)("overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground",r),...l})});f.displayName=s.mY.Group.displayName;let h=l.forwardRef((e,t)=>{let{className:r,...l}=e;return(0,n.jsx)(s.mY.Separator,{ref:t,className:(0,i.cn)("-mx-1 h-px bg-border",r),...l})});h.displayName=s.mY.Separator.displayName;let m=l.forwardRef((e,t)=>{let{className:r,...l}=e;return(0,n.jsx)(s.mY.Item,{ref:t,className:(0,i.cn)("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none aria-disabled:pointer-events-none aria-disabled:opacity-50 aria-selected:bg-accent aria-selected:text-accent-foreground",r),...l})});m.displayName=s.mY.Item.displayName},30220:function(e,t,r){"use strict";r.d(t,{$N:function(){return x},Be:function(){return p},Vq:function(){return o},cN:function(){return m},cZ:function(){return f},fK:function(){return h},hg:function(){return c}});var n=r(36164),l=r(3546),s=r(4318),a=r(1663),i=r(74248);let o=s.fC,c=s.xz,d=s.h_;s.x8;let u=l.forwardRef((e,t)=>{let{className:r,...l}=e;return(0,n.jsx)(s.aV,{ref:t,className:(0,i.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",r),...l})});u.displayName=s.aV.displayName;let f=l.forwardRef((e,t)=>{let{className:r,children:l,...o}=e;return(0,n.jsxs)(d,{children:[(0,n.jsx)(u,{}),(0,n.jsxs)(s.VY,{ref:t,className:(0,i.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",r),...o,children:[l,(0,n.jsxs)(s.x8,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,n.jsx)(a.Z,{className:"h-4 w-4"}),(0,n.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});f.displayName=s.VY.displayName;let h=e=>{let{className:t,...r}=e;return(0,n.jsx)("div",{className:(0,i.cn)("flex flex-col space-y-1.5 text-center sm:text-left",t),...r})};h.displayName="DialogHeader";let m=e=>{let{className:t,...r}=e;return(0,n.jsx)("div",{className:(0,i.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...r})};m.displayName="DialogFooter";let x=l.forwardRef((e,t)=>{let{className:r,...l}=e;return(0,n.jsx)(s.Dx,{ref:t,className:(0,i.cn)("text-lg font-semibold leading-none tracking-tight",r),...l})});x.displayName=s.Dx.displayName;let p=l.forwardRef((e,t)=>{let{className:r,...l}=e;return(0,n.jsx)(s.dk,{ref:t,className:(0,i.cn)("text-sm text-muted-foreground",r),...l})});p.displayName=s.dk.displayName},53538:function(e,t,r){"use strict";r.d(t,{Dp:function(){return o},ee:function(){return i},pO:function(){return a}});var n=r(36164),l=r(6618),s=r(74248);let a=e=>{let{className:t,...r}=e;return(0,n.jsx)(l.eh,{className:(0,s.cn)("flex h-full w-full data-[panel-group-direction=vertical]:flex-col",t),...r})},i=l.s_,o=e=>{let{withHandle:t,className:r,...a}=e;return(0,n.jsx)(l.OT,{className:(0,s.cn)("border-bg relative flex w-px items-center justify-center bg-border after:absolute after:inset-y-0 after:left-1/2 after:w-1 after:-translate-x-1/2 focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring focus-visible:ring-offset-1 data-[panel-group-direction=vertical]:h-px data-[panel-group-direction=vertical]:w-full data-[panel-group-direction=vertical]:after:left-0 data-[panel-group-direction=vertical]:after:h-1 data-[panel-group-direction=vertical]:after:w-full data-[panel-group-direction=vertical]:after:-translate-y-1/2 data-[panel-group-direction=vertical]:after:translate-x-0 [&[data-panel-group-direction=vertical]>div]:rotate-90",r),...a,children:t&&(0,n.jsx)("div",{className:"z-10 flex h-4 w-3 items-center justify-center rounded-sm border bg-border"})})}},54594:function(e,t,r){"use strict";r.d(t,{Bw:function(){return f},DI:function(){return c},Ph:function(){return o},Ql:function(){return m},U$:function(){return x},i4:function(){return u},ki:function(){return d}});var n=r(36164),l=r(3546),s=r(31889),a=r(74248),i=r(81565);let o=s.fC,c=s.ZA,d=s.B4,u=l.forwardRef((e,t)=>{let{className:r,children:l,...o}=e;return(0,n.jsxs)(s.xz,{ref:t,className:(0,a.cn)("flex h-9 w-full items-center justify-between rounded-md border border-input bg-transparent px-3 py-2 text-sm shadow ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",r),...o,children:[l,(0,n.jsx)(s.JO,{asChild:!0,children:(0,n.jsx)(i.IconChevronUpDown,{className:"opacity-50"})})]})});u.displayName=s.xz.displayName;let f=l.forwardRef((e,t)=>{let{className:r,children:l,position:i="popper",...o}=e;return(0,n.jsx)(s.h_,{children:(0,n.jsx)(s.VY,{ref:t,className:(0,a.cn)("relative z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md animate-in fade-in-80","popper"===i&&"translate-y-1",r),position:i,...o,children:(0,n.jsx)(s.l_,{className:(0,a.cn)("p-1","popper"===i&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:l})})})});f.displayName=s.VY.displayName;let h=l.forwardRef((e,t)=>{let{className:r,...l}=e;return(0,n.jsx)(s.__,{ref:t,className:(0,a.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",r),...l})});h.displayName=s.__.displayName;let m=l.forwardRef((e,t)=>{let{className:r,children:l,isPlaceHolder:o,...c}=e;return(0,n.jsxs)(s.ck,{ref:t,className:(0,a.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",r),...c,children:[!o&&(0,n.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,n.jsx)(s.wU,{children:(0,n.jsx)(i.IconCheck,{className:"h-4 w-4"})})}),(0,n.jsx)(s.eT,{children:l})]})});m.displayName=s.ck.displayName;let x=l.forwardRef((e,t)=>{let{className:r,...l}=e;return(0,n.jsx)(s.Z0,{ref:t,className:(0,a.cn)("-mx-1 my-1 h-px bg-muted",r),...l})});x.displayName=s.Z0.displayName},99047:function(e,t,r){"use strict";r.d(t,{RM:function(){return o},SC:function(){return d},iA:function(){return a},pj:function(){return f},ss:function(){return u},xD:function(){return i}});var n=r(36164),l=r(3546),s=r(74248);let a=l.forwardRef((e,t)=>{let{className:r,...l}=e;return(0,n.jsx)("table",{ref:t,className:(0,s.cn)("w-full caption-bottom text-sm",r),...l})});a.displayName="Table";let i=l.forwardRef((e,t)=>{let{className:r,...l}=e;return(0,n.jsx)("thead",{ref:t,className:(0,s.cn)("[&_tr]:border-b",r),...l})});i.displayName="TableHeader";let o=l.forwardRef((e,t)=>{let{className:r,...l}=e;return(0,n.jsx)("tbody",{ref:t,className:(0,s.cn)("[&_tr:last-child]:border-0",r),...l})});o.displayName="TableBody";let c=l.forwardRef((e,t)=>{let{className:r,...l}=e;return(0,n.jsx)("tfoot",{ref:t,className:(0,s.cn)("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",r),...l})});c.displayName="TableFooter";let d=l.forwardRef((e,t)=>{let{className:r,...l}=e;return(0,n.jsx)("tr",{ref:t,className:(0,s.cn)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",r),...l})});d.displayName="TableRow";let u=l.forwardRef((e,t)=>{let{className:r,...l}=e;return(0,n.jsx)("th",{ref:t,className:(0,s.cn)("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",r),...l})});u.displayName="TableHead";let f=l.forwardRef((e,t)=>{let{className:r,...l}=e;return(0,n.jsx)("td",{ref:t,className:(0,s.cn)("p-4 align-middle [&:has([role=checkbox])]:pr-0",r),...l})});f.displayName="TableCell";let h=l.forwardRef((e,t)=>{let{className:r,...l}=e;return(0,n.jsx)("caption",{ref:t,className:(0,s.cn)("mt-4 text-sm text-muted-foreground",r),...l})});h.displayName="TableCaption"},50538:function(e,t,r){"use strict";r.d(t,{SP:function(){return c},dr:function(){return o},mQ:function(){return i},nU:function(){return d}});var n=r(36164),l=r(3546),s=r(6044),a=r(74248);let i=s.fC,o=l.forwardRef((e,t)=>{let{className:r,...l}=e;return(0,n.jsx)(s.aV,{ref:t,className:(0,a.cn)("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",r),...l})});o.displayName=s.aV.displayName;let c=l.forwardRef((e,t)=>{let{className:r,...l}=e;return(0,n.jsx)(s.xz,{ref:t,className:(0,a.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",r),...l})});c.displayName=s.xz.displayName;let d=l.forwardRef((e,t)=>{let{className:r,...l}=e;return(0,n.jsx)(s.VY,{ref:t,className:(0,a.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",r),...l})});d.displayName=s.VY.displayName},93877:function(e,t,r){"use strict";r.d(t,{BT:function(){return o},Ds:function(){return c},Ot:function(){return u},m3:function(){return h}});var n=r(3546);let l=(e,t)=>{let[r,l]=(0,n.useState)(t),[s,a]=(0,n.useState)(!0);return(0,n.useEffect)(()=>{let t=localStorage.getItem(e);t&&l(JSON.parse(t)),a(!1)},[]),[r,t=>{l(t),localStorage.setItem(e,JSON.stringify(t))},s]};class s{get value(){if("undefined"!=typeof localStorage){let e=localStorage.getItem(this.storageKey);if(e)return"true"===e}return this.defaultValue}constructor(e,t,r,n){this.storageKey=e,this.title=t,this.description=r,this.defaultValue=n}}class a{defineGlobalVar(){return new s(this.storageKey,this.title,this.description,this.defaultValue)}defineHook(){return()=>{let[e,t,r]=l(this.storageKey,this.defaultValue);return[{value:e,title:this.title,description:this.description,loading:r},()=>{t(!e)}]}}constructor(e,t,r,n){this.storageKey="EXP_".concat(e),this.title=t,this.description=r,this.defaultValue=null!=n&&n}}let i=new a("enable_code_browser_quick_action_bar","Quick Action Bar","Enable Quick Action Bar to display a convenient toolbar when you select code, offering options to explain the code, add unit tests, and more.",!0),o=i.defineGlobalVar(),c=i.defineHook(),d=new a("enable_search","Search","Enable the search on the home page to search for anything you want to know using the local chat model.",!0);d.defineGlobalVar();let u=d.defineHook(),f=new a("enable_developer_mode","Developer Mode","Enable the developer mode. The features involved include the Answer Engine.",!1);f.defineGlobalVar();let h=f.defineHook()},9010:function(e,t,r){"use strict";r.d(t,{X:function(){return l}});var n=r(28242);function l(){let{theme:e,systemTheme:t,setTheme:r}=(0,n.F)();return{theme:e&&"system"!==e?e:t||"light",setTheme:r,systemTheme:t}}},38785:function(e,t,r){"use strict";r.d(t,{U:function(){return s}});var n=r(3546);let l=!0;function s(){let[e,t]=n.useState(()=>!l);return n.useEffect(function(){l=!1,t(!0)},[]),e}},44645:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});var n=r(3546),l=r(11978);function s(){let e=(0,l.usePathname)(),t=(0,l.useRouter)(),r=(0,l.useSearchParams)(),s=(0,n.useCallback)(e=>{let t=new URLSearchParams(r);e&&Object.entries(e).forEach(e=>{let[r,n]=e;return t.set(r,n)});let n=t.toString();return n.length>0?"?".concat(n):""},[r]),a=(0,n.useCallback)(n=>{let l=function(e,t,r){var n,l;let s=null===(n=r.searchParams)||void 0===n?void 0:n.set,a=null===(l=r.searchParams)||void 0===l?void 0:l.del,i=new URLSearchParams(t);s&&Object.entries(s).forEach(e=>{let[t,r]=e;return i.set(t,r)}),a&&(Array.isArray(a)?a.forEach(e=>i.delete(e)):i.delete(a));let o=i.toString(),c=e;return o.length>0&&(c+="?".concat(o)),r.hash&&(c+="#".concat(r.hash.replace(/^#/,""))),c}((null==n?void 0:n.pathname)||e,r,n);n.replace?t.replace(l):t.push(l)},[e,r]);return{pathname:e,router:t,searchParams:r,getQueryString:s,updateUrlComponents:a}}},25647:function(e,t,r){"use strict";r.d(t,{o:function(){return s}});var n=r(3546),l=r(38785);let s=(e,t)=>{let r=(0,l.U)(),s=e(e=>null==e?void 0:e._hasHydrated),a=e(t),[i,o]=n.useState(r&&s?a:void 0);return n.useEffect(()=>{o(a)},[a]),i}},17451:function(e,t,r){"use strict";r.d(t,{a:function(){return o}});var n=r(27257),l=r(85654),s=r(74248);let a=["_hasHydrated","setHasHydrated","activeChatId"],i={_hasHydrated:!1,chats:void 0,activeChatId:(0,s.x0)()},o=(0,n.Ue)()((0,l.tJ)(e=>({...i,setHasHydrated:t=>{e({_hasHydrated:t})}}),{name:"tabby-chat-storage",partialize:e=>Object.fromEntries(Object.entries(e).filter(e=>{let[t]=e;return!a.includes(t)})),onRehydrateStorage:()=>e=>{e&&e.setHasHydrated(!0)}}))},55823:function(){},65001:function(){},18452:function(e,t,r){"use strict";r.d(t,{m:function(){return a},H:function(){return i}});var n=r(3546),l=r(89704),s=r(95686);function a(e,t){let[r,s]=(0,n.useState)(null),a=!1;return(0,n.useEffect)(()=>{if(e.current&&!a){var r;a=!0,s((r=e.current,(0,l.K)(r,{expose:{navigate:t.navigate,refresh:t.refresh,onSubmitMessage:t.onSubmitMessage,onApplyInEditor:t.onApplyInEditor}})))}},[e.current]),r}function i(e){let[t,r]=(0,n.useState)(null),l=!1;return(0,n.useEffect)(()=>{let t=window.self!==window.top;t&&!l&&(l=!0,r((0,s.c)({expose:{init:e.init,sendMessage:e.sendMessage,showError:e.showError,cleanError:e.cleanError}})))},[]),t}}},function(e){e.O(0,[5870,6056,7998,5498,6312,4007,7950,7980,259,2578,816,1492,4421,7590,1454,5621,3882,8746,4373,739,6193,1889,7982,7651,6618,1566,9736,1565,6597,3375,5289,1744],function(){return e(e.s=4755)}),_N_E=e.O()}]);