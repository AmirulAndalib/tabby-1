(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2666],{90551:function(e,t,n){Promise.resolve().then(n.bind(n,66223))},66223:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return W},getDiskUsageStats:function(){return E}});var r=n(57437),s=n(52273),i=n.n(s),a=n(81860),o=n(61958),l=n(6435),c=n(45253),d=n(57703),u=n(28485),h=n(36612),x=n(33343),f=n(99109),m=n(60106),p=n(70349),v=n(13287),j=n(2265),g=n(16630),w=n(91317),b=n(63303);let k={[p.xj.Chat]:"chat_model",[p.xj.Completion]:"model"};function y(e,t){var n;return{kind:t,device:e.device,addr:"localhost",arch:"",cpuInfo:e.cpu_info,name:null!==(n=null==e?void 0:e[k[t]])&&void 0!==n?n:"",cpuCount:e.cpu_count,cudaDevices:e.cuda_devices}}let N=(0,m.BX)("\n  query GetWorkers {\n    workers {\n      kind\n      name\n      addr\n      device\n      arch\n      cpuInfo\n      cpuCount\n      cudaDevices\n    }\n  }\n");var C=n(7820),M=n(93023),F=n(84168),R=n(51908),z=n(16775),T=n(33555),B=n(70825),Z=n(39311),_=n(86110);function D(e){let{addr:t,name:n,kind:s,device:i,cudaDevices:a,cpuCount:o,cpuInfo:l}=e,c=(0,Z.cn)("ml-2","whitespace-nowrap","overflow-hidden","text-ellipsis"),d="".concat(l," (").concat(o," cores)");return(0,r.jsxs)(_.Zb,{className:"rounded-xl p-2 shadow-md lg:w-[260px]",children:[(0,r.jsx)(_.Ol,{className:"p-0 px-4 pb-2 pt-4",children:(0,r.jsxs)(_.ll,{className:"text-md flex items-center font-normal",children:[(0,r.jsx)(O,{type:s}),(0,r.jsx)("p",{title:n,className:c,children:n})]})}),(0,r.jsxs)(_.aY,{className:"flex flex-col gap-2 p-0 px-4 pb-4 pt-2",children:[(0,r.jsxs)(L,{children:[(0,r.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",className:" h-5 w-5",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,r.jsx)("rect",{x:"16",y:"16",width:"6",height:"6",rx:"1"}),(0,r.jsx)("rect",{x:"2",y:"16",width:"6",height:"6",rx:"1"}),(0,r.jsx)("rect",{x:"9",y:"2",width:"6",height:"6",rx:"1"}),(0,r.jsx)("path",{d:"M5 16v-3a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1v3"}),(0,r.jsx)("path",{d:"M12 12V8"})]}),(0,r.jsx)("p",{title:t,className:c,children:t})]}),(0,r.jsxs)(L,{children:[(0,r.jsxs)("svg",{className:" h-5 w-5",fill:"none",height:"24",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",viewBox:"0 0 24 24",width:"24",xmlns:"http://www.w3.org/2000/svg",children:[(0,r.jsx)("rect",{height:"16",rx:"2",width:"16",x:"4",y:"4"}),(0,r.jsx)("rect",{height:"6",width:"6",x:"9",y:"9"}),(0,r.jsx)("path",{d:"M15 2v2"}),(0,r.jsx)("path",{d:"M15 20v2"}),(0,r.jsx)("path",{d:"M2 15h2"}),(0,r.jsx)("path",{d:"M2 9h2"}),(0,r.jsx)("path",{d:"M20 15h2"}),(0,r.jsx)("path",{d:"M20 9h2"}),(0,r.jsx)("path",{d:"M9 2v2"}),(0,r.jsx)("path",{d:"M9 20v2"})]}),(0,r.jsx)("p",{title:d,className:c,children:d})]}),"cuda"==i&&(null==a?void 0:a.length)&&a.map((e,t)=>(0,r.jsxs)(L,{children:[(0,r.jsxs)("svg",{className:" h-5 w-5",fill:"none",height:"24",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",viewBox:"0 0 24 24",width:"24",xmlns:"http://www.w3.org/2000/svg",children:[(0,r.jsx)("path",{d:"M6 19v-3"}),(0,r.jsx)("path",{d:"M10 19v-3"}),(0,r.jsx)("path",{d:"M14 19v-3"}),(0,r.jsx)("path",{d:"M18 19v-3"}),(0,r.jsx)("path",{d:"M8 11V9"}),(0,r.jsx)("path",{d:"M16 11V9"}),(0,r.jsx)("path",{d:"M12 11V9"}),(0,r.jsx)("path",{d:"M2 15h20"}),(0,r.jsx)("path",{d:"M2 7a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v1.1a2 2 0 0 0 0 3.837V17a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2v-5.1a2 2 0 0 0 0-3.837Z"})]}),(0,r.jsx)("p",{title:e,className:c,children:e})]},t))]})]})}function L(e){let{children:t}=e;return(0,r.jsx)("div",{className:"mt-2 flex items-center text-sm text-card-foreground/70",children:t})}function O(e){let{type:t}=e,n="h-5 w-5";return t==p.xj.Completion?(0,r.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",className:n,width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,r.jsx)("path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"}),(0,r.jsx)("polyline",{points:"14 2 14 8 20 8"}),(0,r.jsx)("path",{d:"m10 13-2 2 2 2"}),(0,r.jsx)("path",{d:"m14 17 2-2-2-2"})]}):t==p.xj.Chat?(0,r.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",className:n,width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,r.jsx)("path",{d:"M14 9a2 2 0 0 1-2 2H6l-4 4V4c0-1.1.9-2 2-2h8a2 2 0 0 1 2 2v5Z"}),(0,r.jsx)("path",{d:"M18 9h2a2 2 0 0 1 2 2v11l-4-4h-6a2 2 0 0 1-2-2v-1"})]}):"INDEX"==t?(0,r.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",className:n,width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,r.jsx)("path",{d:"m9 9-2 2 2 2"}),(0,r.jsx)("path",{d:"m13 13 2-2-2-2"}),(0,r.jsx)("circle",{cx:"11",cy:"11",r:"8"}),(0,r.jsx)("path",{d:"m21 21-4.3-4.3"})]}):void 0}let I=(0,m.BX)("\n  query GetRegistrationToken {\n    registrationToken\n  }\n"),S=(0,m.BX)("\n  mutation ResetRegistrationToken {\n    resetRegistrationToken\n  }\n");function W(){let{data:e}=(0,v.Q)(),t=function(){let{data:e}=(0,v.Q)(),[{data:t}]=(0,f.aM)({query:N}),n=null==t?void 0:t.workers,r=j.useMemo(()=>{let t=(0,b.Z)(n),r=(0,g.Z)(t,{kind:p.xj.Completion})>-1,s=(0,g.Z)(t,{kind:p.xj.Chat})>-1;return!r&&(null==e?void 0:e.model)&&t.push(y(e,p.xj.Completion)),!s&&(null==e?void 0:e.chat_model)&&t.push(y(e,p.xj.Chat)),(0,w.Z)(t,"kind")},[e,n]);return r}(),[{data:n},s]=(0,f.aM)({query:I}),i=(0,C.D)(S,{onCompleted(){s()}});if(e)return(0,r.jsxs)("div",{className:"flex w-full flex-col gap-3",children:[(0,r.jsxs)("h1",{children:[(0,r.jsx)("span",{className:"font-bold",children:"Congratulations"}),", your tabby instance is up!"]}),(0,r.jsx)("span",{className:"flex flex-wrap gap-1",children:(0,r.jsx)("a",{target:"_blank",href:"https://github.com/TabbyML/tabby/releases/tag/".concat(e.version.git_describe),children:(0,r.jsx)("img",{src:"https://img.shields.io/badge/version-".concat(encodeURIComponent(e.version.git_describe.replaceAll("-","--")),"-green")})})}),(0,r.jsx)(z.Z,{}),!!(null==n?void 0:n.registrationToken)&&(0,r.jsxs)("div",{className:"flex items-center gap-1",children:["Registration token:",(0,r.jsx)(R.I,{className:"max-w-[320px] font-mono",value:n.registrationToken,onChange:a.Z}),(0,r.jsx)(M.z,{title:"Rotate",size:"icon",variant:"hover-destructive",onClick:()=>i(),children:(0,r.jsx)(F.IconRotate,{})}),(0,r.jsx)(T.q,{value:n.registrationToken})]}),(0,r.jsxs)("div",{className:"mt-4 flex flex-col gap-4 lg:flex-row lg:flex-wrap",children:[!!(null==t?void 0:t[p.xj.Completion])&&(0,r.jsx)(r.Fragment,{children:t[p.xj.Completion].map((e,t)=>(0,r.jsx)(D,{...e},t))}),!!(null==t?void 0:t[p.xj.Chat])&&(0,r.jsx)(r.Fragment,{children:t[p.xj.Chat].map((e,t)=>(0,r.jsx)(D,{...e},t))}),(0,r.jsx)(D,{addr:"localhost",name:"Code Search Index",kind:"INDEX",arch:"",device:e.device,cudaDevices:e.cuda_devices,cpuCount:e.cpu_count,cpuInfo:e.cpu_info})]}),(0,r.jsx)(z.Z,{className:"mt-6"}),(0,r.jsx)(U,{})]})}let E=(0,m.BX)("\n  query GetDiskUsageStats {\n    diskUsageStats {\n      events {\n        filePaths\n        size\n      }\n      indexedRepositories {\n        filePaths\n        size\n      }\n      database {\n        filePaths\n        size\n      }\n      models {\n        filePaths\n        size\n      }\n    }\n  }\n"),q=[{label:"Model",key:"models",color:"#0088FE"},{label:"Indexing",key:"indexedRepositories",color:"#00C49F"},{label:"Event Logs",key:"events",color:"#FF8042"},{label:"Other",key:"database",color:"#FFBB28"}];function U(){let[{data:e,fetching:t}]=(0,f.aM)({query:E}),n=[],s=0;return e&&(n=q.map(t=>{if(!e.diskUsageStats[t.key])return null;let n=e.diskUsageStats[t.key];return{...t,size:n.size}}).filter(e=>e),s=(0,o.Z)(n.map(e=>e.size))),(0,r.jsx)(B.Z,{loading:t,fallback:(0,r.jsx)(r.Fragment,{}),children:(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"font-bold",children:"Disk Usage"}),(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:"Storage utilization by Type"})]}),(0,r.jsxs)("div",{className:"flex flex-col items-center gap-x-3 md:flex-row",children:[(0,r.jsx)(c.h,{width:230,height:220,children:(0,r.jsx)(d.u,{children:(0,r.jsxs)(u.b,{data:n,dataKey:"size",cx:110,cy:100,innerRadius:70,outerRadius:90,stroke:"none",children:[n.map(e=>(0,r.jsx)(h.b,{fill:e.color},e.key)),(0,r.jsx)(x._,{content:(0,r.jsx)(V,{totalUsage:s}),position:"center"})]})})}),(0,r.jsx)("div",{className:"flex w-full flex-col gap-y-2 md:ml-10 md:w-auto",children:n.map(e=>(0,r.jsxs)("div",{className:"flex cursor-default items-center justify-between text-xs",children:[(0,r.jsxs)("div",{className:"flex w-40 items-center",children:[(0,r.jsx)("div",{className:"mr-1.5 h-3 w-3 rounded",style:{backgroundColor:e.color}}),(0,r.jsx)("p",{className:"font-semibold",children:e.label})]}),(0,r.jsx)("p",{children:H(e.size)})]},e.key))})]})]})})}function V(e){let{viewBox:t,totalUsage:n}=e,{theme:s}=(0,l.F)();if(!t)return;let{cx:i,cy:a}=t;return(0,r.jsxs)("g",{children:[(0,r.jsx)("text",{x:i,y:a-20,textAnchor:"middle",dominantBaseline:"central",alignmentBaseline:"middle",fill:"dark"===s?"#FDFDFD":"#030302",className:"text-sm",children:"Total Usage"}),(0,r.jsx)("text",{x:i,y:a+13,textAnchor:"middle",dominantBaseline:"central",alignmentBaseline:"middle",fill:"dark"===s?"#FDFDFD":"#030302",className:"text-lg font-semibold",children:H(n)})]})}function H(e){return i()(1024*e,{unitSeparator:" "})}},33555:function(e,t,n){"use strict";n.d(t,{q:function(){return o}});var r=n(57437);n(2265);var s=n(77723),i=n(93023),a=n(84168);function o(e){let{className:t,value:n,...o}=e,{isCopied:l,copyToClipboard:c}=(0,s.m)({timeout:2e3});return n?(0,r.jsxs)(i.z,{variant:"ghost",size:"icon",className:t,onClick:()=>{l||c(n)},...o,children:[l?(0,r.jsx)(a.IconCheck,{className:"text-green-600"}):(0,r.jsx)(a.IconCopy,{}),(0,r.jsx)("span",{className:"sr-only",children:"Copy"})]}):null}},70825:function(e,t,n){"use strict";var r=n(57437),s=n(2265),i=n(36850),a=n(93111);t.Z=e=>{let{loading:t,fallback:n,delay:o,children:l}=e,[c,d]=s.useState(!t),[u]=(0,i.n)(c,null!=o?o:200);return(s.useEffect(()=>{t||c||d(!0)},[t]),u)?l:n||(0,r.jsx)(a.cg,{})}},93111:function(e,t,n){"use strict";n.d(t,{PF:function(){return l},cg:function(){return a},tB:function(){return o}});var r=n(57437),s=n(39311),i=n(25645);let a=e=>{let{className:t,...n}=e;return(0,r.jsxs)("div",{className:(0,s.cn)("space-y-3",t),...n,children:[(0,r.jsx)(i.O,{className:"h-4 w-full"}),(0,r.jsx)(i.O,{className:"h-4 w-full"}),(0,r.jsx)(i.O,{className:"h-4 w-full"}),(0,r.jsx)(i.O,{className:"h-4 w-full"})]})},o=e=>{let{className:t,...n}=e;return(0,r.jsx)(i.O,{className:(0,s.cn)("h-4 w-full",t),...n})},l=e=>{let{className:t,...n}=e;return(0,r.jsxs)("div",{className:(0,s.cn)("flex flex-col gap-3",t),...n,children:[(0,r.jsx)(i.O,{className:"h-4 w-[20%]"}),(0,r.jsx)(i.O,{className:"h-4 w-full"}),(0,r.jsx)(i.O,{className:"h-4 w-[20%]"}),(0,r.jsx)(i.O,{className:"h-4 w-full"})]})}},93023:function(e,t,n){"use strict";n.d(t,{d:function(){return l},z:function(){return c}});var r=n(57437),s=n(2265),i=n(67256),a=n(7404),o=n(39311);let l=(0,a.j)("inline-flex items-center justify-center rounded-md text-sm font-medium shadow ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground shadow-md hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90","hover-destructive":"shadow-none hover:bg-destructive/90 hover:text-destructive-foreground",outline:"border border-input hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"shadow-none hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 shadow-none hover:underline"},size:{default:"h-8 px-4 py-2",sm:"h-8 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-8 w-8 p-0"}},defaultVariants:{variant:"default",size:"default"}}),c=s.forwardRef((e,t)=>{let{className:n,variant:s,size:a,asChild:c=!1,...d}=e,u=c?i.g7:"button";return(0,r.jsx)(u,{className:(0,o.cn)(l({variant:s,size:a,className:n})),ref:t,...d})});c.displayName="Button"},86110:function(e,t,n){"use strict";n.d(t,{Ol:function(){return o},Zb:function(){return a},aY:function(){return d},eW:function(){return u},ll:function(){return l}});var r=n(57437),s=n(2265),i=n(39311);let a=s.forwardRef((e,t)=>{let{className:n,...s}=e;return(0,r.jsx)("div",{ref:t,className:(0,i.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",n),...s})});a.displayName="Card";let o=s.forwardRef((e,t)=>{let{className:n,...s}=e;return(0,r.jsx)("div",{ref:t,className:(0,i.cn)("flex flex-col space-y-1.5 p-6",n),...s})});o.displayName="CardHeader";let l=s.forwardRef((e,t)=>{let{className:n,...s}=e;return(0,r.jsx)("h3",{ref:t,className:(0,i.cn)("text-2xl font-semibold leading-none tracking-tight",n),...s})});l.displayName="CardTitle";let c=s.forwardRef((e,t)=>{let{className:n,...s}=e;return(0,r.jsx)("p",{ref:t,className:(0,i.cn)("text-sm text-muted-foreground",n),...s})});c.displayName="CardDescription";let d=s.forwardRef((e,t)=>{let{className:n,...s}=e;return(0,r.jsx)("div",{ref:t,className:(0,i.cn)("p-6 pt-0",n),...s})});d.displayName="CardContent";let u=s.forwardRef((e,t)=>{let{className:n,...s}=e;return(0,r.jsx)("div",{ref:t,className:(0,i.cn)("flex items-center p-6 pt-0",n),...s})});u.displayName="CardFooter"},51908:function(e,t,n){"use strict";n.d(t,{I:function(){return a}});var r=n(57437),s=n(2265),i=n(39311);let a=s.forwardRef((e,t)=>{let{className:n,type:s,...a}=e;return(0,r.jsx)("input",{type:s,className:(0,i.cn)("flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-2 text-sm shadow-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",n),ref:t,...a})});a.displayName="Input"},16775:function(e,t,n){"use strict";n.d(t,{Z:function(){return o}});var r=n(57437),s=n(2265),i=n(26823),a=n(39311);let o=s.forwardRef((e,t)=>{let{className:n,orientation:s="horizontal",decorative:o=!0,...l}=e;return(0,r.jsx)(i.f,{ref:t,decorative:o,orientation:s,className:(0,a.cn)("shrink-0 bg-border","horizontal"===s?"h-[1px] w-full":"h-full w-[1px]",n),...l})});o.displayName=i.f.displayName},25645:function(e,t,n){"use strict";n.d(t,{O:function(){return i}});var r=n(57437),s=n(39311);function i(e){let{className:t,...n}=e;return(0,r.jsx)("div",{className:(0,s.cn)("h-4 animate-pulse rounded-md bg-gray-200 dark:bg-gray-700",t),...n})}},77723:function(e,t,n){"use strict";n.d(t,{m:function(){return o}});var r=n(2265),s=n(2390),i=n.n(s),a=n(71424);function o(e){let{timeout:t=2e3,onError:n}=e,[s,o]=r.useState(!1),l=()=>{o(!0),setTimeout(()=>{o(!1)},t)},c=e=>{if("function"==typeof n){null==n||n(e);return}a.A.error("Failed to copy.")};return{isCopied:s,copyToClipboard:e=>{var t;if(e){if(null===(t=navigator.clipboard)||void 0===t?void 0:t.writeText)navigator.clipboard.writeText(e).then(l).catch(c);else{let t=i()(e);t?l():c()}}}}}},36850:function(e,t,n){"use strict";n.d(t,{S:function(){return o},n:function(){return l}});var r=n(2265),s=n(50976),i=n(15357);let a=e=>{let t=(0,i.d)(e);r.useEffect(()=>()=>{t.current()},[])};function o(e,t,n){let o=(0,i.d)(e),l=r.useMemo(()=>(0,s.Z)(function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return o.current(...t)},t,n),[]);return a(()=>l.cancel()),{run:l,cancel:l.cancel,flush:l.flush}}function l(e,t,n){let[s,i]=r.useState(e),{run:a}=o(()=>{i(e)},t,n);return r.useEffect(()=>{a()},[e]),[s,i]}},13287:function(e,t,n){"use strict";n.d(t,{Q:function(){return i}});var r=n(30713),s=n(1592);function i(){return(0,r.ZP)("/v1/health",s.Z)}},15357:function(e,t,n){"use strict";n.d(t,{d:function(){return s}});var r=n(2265);function s(e){let t=r.useRef(e);return t.current=e,t}},1592:function(e,t,n){"use strict";n.d(t,{Z:function(){return l}});var r=n(34084),s=n(53771),i=n(58001),a=n(7820),o=n(37004);async function l(e,t){var n;let r=null!==(n=null==t?void 0:t.customFetch)&&void 0!==n?n:window.fetch;if(function(e){var t;if(e.startsWith("/oauth/providers"))return!1;let n=null===(t=(0,o.bW)())||void 0===t?void 0:t.accessToken;if(!n)return!0;try{let{exp:e}=(0,s.o)(n);return!e||(0,o.pw)(e)}catch(e){return!0}}(e))return o.wG.refreshToken(c).then(n=>h(e,t));let i=await r(e,d(t));return 401===i.status?o.wG.refreshToken(c).then(n=>h(e,t)):x(i,t)}async function c(){var e,t;let n=null===(e=(0,o.bW)())||void 0===e?void 0:e.refreshToken;if(!n)return;let r=await u(n);return null==r?void 0:null===(t=r.data)||void 0===t?void 0:t.refreshToken}function d(e){var t;let n=new Headers(null==e?void 0:e.headers);return n.append("authorization","Bearer ".concat(null===(t=(0,o.bW)())||void 0===t?void 0:t.accessToken)),{...e||{},headers:n}}async function u(e){let t=a.L.createRequestOperation("mutation",(0,r.h)(i.Dp,{refreshToken:e}));return a.L.executeMutation(t)}function h(e,t){var n;let r=null!==(n=null==t?void 0:t.customFetch)&&void 0!==n?n:window.fetch;return r(e,d(t)).then(e=>x(e,t))}function x(e,t){return(null==e?void 0:e.ok)?(null==t?void 0:t.responseFormatter)?t.responseFormatter(e):(null==t?void 0:t.responseFormat)==="blob"?e.blob():e.json():(null==t?void 0:t.errorHandler)?t.errorHandler(e):void 0}}},function(e){e.O(0,[768,9109,584,1424,7463,6630,713,3068,1037,7753,4168,2445,2971,7864,1744],function(){return e(e.s=90551)}),_N_E=e.O()}]);